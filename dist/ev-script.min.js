!function(e,t){"function"==typeof define&&define.amd?define(["jquery","plupload","jquery-ui","jquery.plupload.queue"],t):e.EV=t(e.$,e.plupload)}(this,function(e,t){var i,s,n;return function(e){function t(e,t){return x.call(e,t)}function r(e,t){var i,s,n,r,a,o,l,c,u,h,d,p,f=t&&t.split("/"),m=y.map,g=m&&m["*"]||{};if(e){for(e=e.split("/"),a=e.length-1,y.nodeIdCompat&&S.test(e[a])&&(e[a]=e[a].replace(S,"")),"."===e[0].charAt(0)&&f&&(p=f.slice(0,f.length-1),e=p.concat(e)),u=0;u<e.length;u++)if(d=e[u],"."===d)e.splice(u,1),u-=1;else if(".."===d){if(0===u||1===u&&".."===e[2]||".."===e[u-1])continue;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}if((f||g)&&m){for(i=e.split("/"),u=i.length;u>0;u-=1){if(s=i.slice(0,u).join("/"),f)for(h=f.length;h>0;h-=1)if(n=m[f.slice(0,h).join("/")],n&&(n=n[s])){r=n,o=u;break}if(r)break;!l&&g&&g[s]&&(l=g[s],c=u)}!r&&l&&(r=l,o=c),r&&(i.splice(0,o,r),e=i.join("/"))}return e}function a(t,i){return function(){var s=k.call(arguments,0);return"string"!=typeof s[0]&&1===s.length&&s.push(null),f.apply(e,s.concat([t,i]))}}function o(e){return function(t){return r(t,e)}}function l(e){return function(t){v[e]=t}}function c(i){if(t(b,i)){var s=b[i];delete b[i],w[i]=!0,p.apply(e,s)}if(!t(v,i)&&!t(w,i))throw new Error("No "+i);return v[i]}function u(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function h(e){return e?u(e):[]}function d(e){return function(){return y&&y.config&&y.config[e]||{}}}var p,f,m,g,v={},b={},y={},w={},x=Object.prototype.hasOwnProperty,k=[].slice,S=/\.js$/;m=function(e,t){var i,s=u(e),n=s[0],a=t[1];return e=s[1],n&&(n=r(n,a),i=c(n)),n?e=i&&i.normalize?i.normalize(e,o(a)):r(e,a):(e=r(e,a),s=u(e),n=s[0],e=s[1],n&&(i=c(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:i}},g={require:function(e){return a(e)},exports:function(e){var t=v[e];return"undefined"!=typeof t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:d(e)}}},p=function(i,s,n,r){var o,u,d,p,f,y,x,k=[],S=typeof n;if(r=r||i,y=h(r),"undefined"===S||"function"===S){for(s=!s.length&&n.length?["require","exports","module"]:s,f=0;f<s.length;f+=1)if(p=m(s[f],y),u=p.f,"require"===u)k[f]=g.require(i);else if("exports"===u)k[f]=g.exports(i),x=!0;else if("module"===u)o=k[f]=g.module(i);else if(t(v,u)||t(b,u)||t(w,u))k[f]=c(u);else{if(!p.p)throw new Error(i+" missing "+u);p.p.load(p.n,a(r,!0),l(u),{}),k[f]=v[u]}d=n?n.apply(v[i],k):void 0,i&&(o&&o.exports!==e&&o.exports!==v[i]?v[i]=o.exports:d===e&&x||(v[i]=d))}else i&&(v[i]=n)},i=s=f=function(t,i,s,n,r){if("string"==typeof t)return g[t]?g[t](i):c(m(t,h(i)).f);if(!t.splice){if(y=t,y.deps&&f(y.deps,y.callback),!i)return;i.splice?(t=i,i=s,s=null):t=e}return i=i||function(){},"function"==typeof s&&(s=n,n=r),n?p(e,t,i,s):setTimeout(function(){p(e,t,i,s)},4),f},f.config=function(e){return f(e)},i._defined=v,n=function(e,i,s){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");i.splice||(s=i,i=[]),t(v,e)||t(b,e)||(b[e]=[e,i,s])},n.amd={jQuery:!0}}(),n("bower_components/almond/almond",function(){}),function(){function e(e){function t(t,i,s,n,r,a){for(;r>=0&&a>r;r+=e){var o=n?n[r]:r;s=i(s,t[o],o,t)}return s}return function(i,s,n,r){s=w(s,r,4);var a=!E(i)&&y.keys(i),o=(a||i).length,l=e>0?0:o-1;return arguments.length<3&&(n=i[a?a[l]:l],l+=e),t(i,s,n,a,l,o)}}function t(e){return function(t,i,s){i=x(i,s);for(var n=$(t),r=e>0?0:n-1;r>=0&&n>r;r+=e)if(i(t[r],r,t))return r;return-1}}function i(e,t,i){return function(s,n,r){var a=0,o=$(s);if("number"==typeof r)e>0?a=r>=0?r:Math.max(r+o,a):o=r>=0?Math.min(r+1,o):r+o+1;else if(i&&r&&o)return r=i(s,n),s[r]===n?r:-1;if(n!==n)return r=t(h.call(s,a,o),y.isNaN),r>=0?r+a:-1;for(r=e>0?a:o-1;r>=0&&o>r;r+=e)if(s[r]===n)return r;return-1}}function s(e,t){var i=j.length,s=e.constructor,n=y.isFunction(s)&&s.prototype||l,r="constructor";for(y.has(e,r)&&!y.contains(t,r)&&t.push(r);i--;)r=j[i],r in e&&e[r]!==n[r]&&!y.contains(t,r)&&t.push(r)}var r=this,a=r._,o=Array.prototype,l=Object.prototype,c=Function.prototype,u=o.push,h=o.slice,d=l.toString,p=l.hasOwnProperty,f=Array.isArray,m=Object.keys,g=c.bind,v=Object.create,b=function(){},y=function(e){return e instanceof y?e:this instanceof y?void(this._wrapped=e):new y(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):r._=y,y.VERSION="1.8.3";var w=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,s){return e.call(t,i,s)};case 3:return function(i,s,n){return e.call(t,i,s,n)};case 4:return function(i,s,n,r){return e.call(t,i,s,n,r)}}return function(){return e.apply(t,arguments)}},x=function(e,t,i){return null==e?y.identity:y.isFunction(e)?w(e,t,i):y.isObject(e)?y.matcher(e):y.property(e)};y.iteratee=function(e,t){return x(e,t,1/0)};var k=function(e,t){return function(i){var s=arguments.length;if(2>s||null==i)return i;for(var n=1;s>n;n++)for(var r=arguments[n],a=e(r),o=a.length,l=0;o>l;l++){var c=a[l];t&&void 0!==i[c]||(i[c]=r[c])}return i}},S=function(e){if(!y.isObject(e))return{};if(v)return v(e);b.prototype=e;var t=new b;return b.prototype=null,t},C=function(e){return function(t){return null==t?void 0:t[e]}},I=Math.pow(2,53)-1,$=C("length"),E=function(e){var t=$(e);return"number"==typeof t&&t>=0&&I>=t};y.each=y.forEach=function(e,t,i){t=w(t,i);var s,n;if(E(e))for(s=0,n=e.length;n>s;s++)t(e[s],s,e);else{var r=y.keys(e);for(s=0,n=r.length;n>s;s++)t(e[r[s]],r[s],e)}return e},y.map=y.collect=function(e,t,i){t=x(t,i);for(var s=!E(e)&&y.keys(e),n=(s||e).length,r=Array(n),a=0;n>a;a++){var o=s?s[a]:a;r[a]=t(e[o],o,e)}return r},y.reduce=y.foldl=y.inject=e(1),y.reduceRight=y.foldr=e(-1),y.find=y.detect=function(e,t,i){var s;return s=E(e)?y.findIndex(e,t,i):y.findKey(e,t,i),void 0!==s&&-1!==s?e[s]:void 0},y.filter=y.select=function(e,t,i){var s=[];return t=x(t,i),y.each(e,function(e,i,n){t(e,i,n)&&s.push(e)}),s},y.reject=function(e,t,i){return y.filter(e,y.negate(x(t)),i)},y.every=y.all=function(e,t,i){t=x(t,i);for(var s=!E(e)&&y.keys(e),n=(s||e).length,r=0;n>r;r++){var a=s?s[r]:r;if(!t(e[a],a,e))return!1}return!0},y.some=y.any=function(e,t,i){t=x(t,i);for(var s=!E(e)&&y.keys(e),n=(s||e).length,r=0;n>r;r++){var a=s?s[r]:r;if(t(e[a],a,e))return!0}return!1},y.contains=y.includes=y.include=function(e,t,i,s){return E(e)||(e=y.values(e)),("number"!=typeof i||s)&&(i=0),y.indexOf(e,t,i)>=0},y.invoke=function(e,t){var i=h.call(arguments,2),s=y.isFunction(t);return y.map(e,function(e){var n=s?t:e[t];return null==n?n:n.apply(e,i)})},y.pluck=function(e,t){return y.map(e,y.property(t))},y.where=function(e,t){return y.filter(e,y.matcher(t))},y.findWhere=function(e,t){return y.find(e,y.matcher(t))},y.max=function(e,t,i){var s,n,r=-(1/0),a=-(1/0);if(null==t&&null!=e){e=E(e)?e:y.values(e);for(var o=0,l=e.length;l>o;o++)s=e[o],s>r&&(r=s)}else t=x(t,i),y.each(e,function(e,i,s){n=t(e,i,s),(n>a||n===-(1/0)&&r===-(1/0))&&(r=e,a=n)});return r},y.min=function(e,t,i){var s,n,r=1/0,a=1/0;if(null==t&&null!=e){e=E(e)?e:y.values(e);for(var o=0,l=e.length;l>o;o++)s=e[o],r>s&&(r=s)}else t=x(t,i),y.each(e,function(e,i,s){n=t(e,i,s),(a>n||n===1/0&&r===1/0)&&(r=e,a=n)});return r},y.shuffle=function(e){for(var t,i=E(e)?e:y.values(e),s=i.length,n=Array(s),r=0;s>r;r++)t=y.random(0,r),t!==r&&(n[r]=n[t]),n[t]=i[r];return n},y.sample=function(e,t,i){return null==t||i?(E(e)||(e=y.values(e)),e[y.random(e.length-1)]):y.shuffle(e).slice(0,Math.max(0,t))},y.sortBy=function(e,t,i){return t=x(t,i),y.pluck(y.map(e,function(e,i,s){return{value:e,index:i,criteria:t(e,i,s)}}).sort(function(e,t){var i=e.criteria,s=t.criteria;if(i!==s){if(i>s||void 0===i)return 1;if(s>i||void 0===s)return-1}return e.index-t.index}),"value")};var A=function(e){return function(t,i,s){var n={};return i=x(i,s),y.each(t,function(s,r){var a=i(s,r,t);e(n,s,a)}),n}};y.groupBy=A(function(e,t,i){y.has(e,i)?e[i].push(t):e[i]=[t]}),y.indexBy=A(function(e,t,i){e[i]=t}),y.countBy=A(function(e,t,i){y.has(e,i)?e[i]++:e[i]=1}),y.toArray=function(e){return e?y.isArray(e)?h.call(e):E(e)?y.map(e,y.identity):y.values(e):[]},y.size=function(e){return null==e?0:E(e)?e.length:y.keys(e).length},y.partition=function(e,t,i){t=x(t,i);var s=[],n=[];return y.each(e,function(e,i,r){(t(e,i,r)?s:n).push(e)}),[s,n]},y.first=y.head=y.take=function(e,t,i){return null!=e?null==t||i?e[0]:y.initial(e,e.length-t):void 0},y.initial=function(e,t,i){return h.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},y.last=function(e,t,i){return null!=e?null==t||i?e[e.length-1]:y.rest(e,Math.max(0,e.length-t)):void 0},y.rest=y.tail=y.drop=function(e,t,i){return h.call(e,null==t||i?1:t)},y.compact=function(e){return y.filter(e,y.identity)};var P=function(e,t,i,s){for(var n=[],r=0,a=s||0,o=$(e);o>a;a++){var l=e[a];if(E(l)&&(y.isArray(l)||y.isArguments(l))){t||(l=P(l,t,i));var c=0,u=l.length;for(n.length+=u;u>c;)n[r++]=l[c++]}else i||(n[r++]=l)}return n};y.flatten=function(e,t){return P(e,t,!1)},y.without=function(e){return y.difference(e,h.call(arguments,1))},y.uniq=y.unique=function(e,t,i,s){y.isBoolean(t)||(s=i,i=t,t=!1),null!=i&&(i=x(i,s));for(var n=[],r=[],a=0,o=$(e);o>a;a++){var l=e[a],c=i?i(l,a,e):l;t?(a&&r===c||n.push(l),r=c):i?y.contains(r,c)||(r.push(c),n.push(l)):y.contains(n,l)||n.push(l)}return n},y.union=function(){return y.uniq(P(arguments,!0,!0))},y.intersection=function(e){for(var t=[],i=arguments.length,s=0,n=$(e);n>s;s++){var r=e[s];if(!y.contains(t,r)){for(var a=1;i>a&&y.contains(arguments[a],r);a++);a===i&&t.push(r)}}return t},y.difference=function(e){var t=P(arguments,!0,!0,1);return y.filter(e,function(e){return!y.contains(t,e)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(e){for(var t=e&&y.max(e,$).length||0,i=Array(t),s=0;t>s;s++)i[s]=y.pluck(e,s);return i},y.object=function(e,t){for(var i={},s=0,n=$(e);n>s;s++)t?i[e[s]]=t[s]:i[e[s][0]]=e[s][1];return i},y.findIndex=t(1),y.findLastIndex=t(-1),y.sortedIndex=function(e,t,i,s){i=x(i,s,1);for(var n=i(t),r=0,a=$(e);a>r;){var o=Math.floor((r+a)/2);i(e[o])<n?r=o+1:a=o}return r},y.indexOf=i(1,y.findIndex,y.sortedIndex),y.lastIndexOf=i(-1,y.findLastIndex),y.range=function(e,t,i){null==t&&(t=e||0,e=0),i=i||1;for(var s=Math.max(Math.ceil((t-e)/i),0),n=Array(s),r=0;s>r;r++,e+=i)n[r]=e;return n};var M=function(e,t,i,s,n){if(!(s instanceof t))return e.apply(i,n);var r=S(e.prototype),a=e.apply(r,n);return y.isObject(a)?a:r};y.bind=function(e,t){if(g&&e.bind===g)return g.apply(e,h.call(arguments,1));if(!y.isFunction(e))throw new TypeError("Bind must be called on a function");var i=h.call(arguments,2),s=function(){return M(e,s,t,this,i.concat(h.call(arguments)))};return s},y.partial=function(e){var t=h.call(arguments,1),i=function(){for(var s=0,n=t.length,r=Array(n),a=0;n>a;a++)r[a]=t[a]===y?arguments[s++]:t[a];for(;s<arguments.length;)r.push(arguments[s++]);return M(e,i,this,this,r)};return i},y.bindAll=function(e){var t,i,s=arguments.length;if(1>=s)throw new Error("bindAll must be passed function names");for(t=1;s>t;t++)i=arguments[t],e[i]=y.bind(e[i],e);return e},y.memoize=function(e,t){var i=function(s){var n=i.cache,r=""+(t?t.apply(this,arguments):s);return y.has(n,r)||(n[r]=e.apply(this,arguments)),n[r]};return i.cache={},i},y.delay=function(e,t){var i=h.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},y.defer=y.partial(y.delay,y,1),y.throttle=function(e,t,i){var s,n,r,a=null,o=0;i||(i={});var l=function(){o=i.leading===!1?0:y.now(),a=null,r=e.apply(s,n),a||(s=n=null)};return function(){var c=y.now();o||i.leading!==!1||(o=c);var u=t-(c-o);return s=this,n=arguments,0>=u||u>t?(a&&(clearTimeout(a),a=null),o=c,r=e.apply(s,n),a||(s=n=null)):a||i.trailing===!1||(a=setTimeout(l,u)),r}},y.debounce=function(e,t,i){var s,n,r,a,o,l=function(){var c=y.now()-a;t>c&&c>=0?s=setTimeout(l,t-c):(s=null,i||(o=e.apply(r,n),s||(r=n=null)))};return function(){r=this,n=arguments,a=y.now();var c=i&&!s;return s||(s=setTimeout(l,t)),c&&(o=e.apply(r,n),r=n=null),o}},y.wrap=function(e,t){return y.partial(t,e)},y.negate=function(e){return function(){return!e.apply(this,arguments)}},y.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,s=e[t].apply(this,arguments);i--;)s=e[i].call(this,s);return s}},y.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},y.before=function(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),1>=e&&(t=null),i}},y.once=y.partial(y.before,2);var O=!{toString:null}.propertyIsEnumerable("toString"),j=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(e){if(!y.isObject(e))return[];if(m)return m(e);var t=[];for(var i in e)y.has(e,i)&&t.push(i);return O&&s(e,t),t},y.allKeys=function(e){if(!y.isObject(e))return[];var t=[];for(var i in e)t.push(i);return O&&s(e,t),t},y.values=function(e){for(var t=y.keys(e),i=t.length,s=Array(i),n=0;i>n;n++)s[n]=e[t[n]];return s},y.mapObject=function(e,t,i){t=x(t,i);for(var s,n=y.keys(e),r=n.length,a={},o=0;r>o;o++)s=n[o],a[s]=t(e[s],s,e);return a},y.pairs=function(e){for(var t=y.keys(e),i=t.length,s=Array(i),n=0;i>n;n++)s[n]=[t[n],e[t[n]]];return s},y.invert=function(e){for(var t={},i=y.keys(e),s=0,n=i.length;n>s;s++)t[e[i[s]]]=i[s];return t},y.functions=y.methods=function(e){var t=[];for(var i in e)y.isFunction(e[i])&&t.push(i);return t.sort()},y.extend=k(y.allKeys),y.extendOwn=y.assign=k(y.keys),y.findKey=function(e,t,i){t=x(t,i);for(var s,n=y.keys(e),r=0,a=n.length;a>r;r++)if(s=n[r],t(e[s],s,e))return s},y.pick=function(e,t,i){var s,n,r={},a=e;if(null==a)return r;y.isFunction(t)?(n=y.allKeys(a),s=w(t,i)):(n=P(arguments,!1,!1,1),s=function(e,t,i){return t in i},a=Object(a));for(var o=0,l=n.length;l>o;o++){var c=n[o],u=a[c];s(u,c,a)&&(r[c]=u)}return r},y.omit=function(e,t,i){if(y.isFunction(t))t=y.negate(t);else{var s=y.map(P(arguments,!1,!1,1),String);t=function(e,t){return!y.contains(s,t)}}return y.pick(e,t,i)},y.defaults=k(y.allKeys,!0),y.create=function(e,t){var i=S(e);return t&&y.extendOwn(i,t),i},y.clone=function(e){return y.isObject(e)?y.isArray(e)?e.slice():y.extend({},e):e},y.tap=function(e,t){return t(e),e},y.isMatch=function(e,t){var i=y.keys(t),s=i.length;if(null==e)return!s;for(var n=Object(e),r=0;s>r;r++){var a=i[r];if(t[a]!==n[a]||!(a in n))return!1}return!0};var _=function(e,t,i,s){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof y&&(e=e._wrapped),t instanceof y&&(t=t._wrapped);var n=d.call(e);if(n!==d.call(t))return!1;switch(n){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var r="[object Array]"===n;if(!r){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,o=t.constructor;if(a!==o&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1}i=i||[],s=s||[];for(var l=i.length;l--;)if(i[l]===e)return s[l]===t;if(i.push(e),s.push(t),r){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!_(e[l],t[l],i,s))return!1}else{var c,u=y.keys(e);if(l=u.length,y.keys(t).length!==l)return!1;for(;l--;)if(c=u[l],!y.has(t,c)||!_(e[c],t[c],i,s))return!1}return i.pop(),s.pop(),!0};y.isEqual=function(e,t){return _(e,t)},y.isEmpty=function(e){return null==e?!0:E(e)&&(y.isArray(e)||y.isString(e)||y.isArguments(e))?0===e.length:0===y.keys(e).length},y.isElement=function(e){return!(!e||1!==e.nodeType)},y.isArray=f||function(e){return"[object Array]"===d.call(e)},y.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){y["is"+e]=function(t){return d.call(t)==="[object "+e+"]"}}),y.isArguments(arguments)||(y.isArguments=function(e){return y.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(e){return"function"==typeof e||!1}),y.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},y.isNaN=function(e){return y.isNumber(e)&&e!==+e},y.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===d.call(e)},y.isNull=function(e){return null===e},y.isUndefined=function(e){return void 0===e},y.has=function(e,t){return null!=e&&p.call(e,t)},y.noConflict=function(){return r._=a,this},y.identity=function(e){return e},y.constant=function(e){return function(){return e}},y.noop=function(){},y.property=C,y.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},y.matcher=y.matches=function(e){return e=y.extendOwn({},e),function(t){return y.isMatch(t,e)}},y.times=function(e,t,i){var s=Array(Math.max(0,e));t=w(t,i,1);for(var n=0;e>n;n++)s[n]=t(n);return s},y.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},y.now=Date.now||function(){return(new Date).getTime()};var T={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},z=y.invert(T),L=function(e){var t=function(t){return e[t]},i="(?:"+y.keys(e).join("|")+")",s=RegExp(i),n=RegExp(i,"g");return function(e){return e=null==e?"":""+e,s.test(e)?e.replace(n,t):e}};y.escape=L(T),y.unescape=L(z),y.result=function(e,t,i){var s=null==e?void 0:e[t];return void 0===s&&(s=i),y.isFunction(s)?s.call(e):s};var D=0;y.uniqueId=function(e){var t=++D+"";return e?e+t:t},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\u2028|\u2029/g,H=function(e){return"\\"+U[e]};y.template=function(e,t,i){!t&&i&&(t=i),t=y.defaults({},t,y.templateSettings);var s=RegExp([(t.escape||q).source,(t.interpolate||q).source,(t.evaluate||q).source].join("|")+"|$","g"),n=0,r="__p+='";e.replace(s,function(t,i,s,a,o){return r+=e.slice(n,o).replace(R,H),n=o+t.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":s?r+="'+\n((__t=("+s+"))==null?'':__t)+\n'":a&&(r+="';\n"+a+"\n__p+='"),t}),r+="';\n",t.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var a=new Function(t.variable||"obj","_",r)}catch(o){throw o.source=r,o}var l=function(e){return a.call(this,e,y)},c=t.variable||"obj";return l.source="function("+c+"){\n"+r+"}",l},y.chain=function(e){var t=y(e);return t._chain=!0,t};var N=function(e,t){return e._chain?y(t).chain():t};y.mixin=function(e){y.each(y.functions(e),function(t){var i=y[t]=e[t];y.prototype[t]=function(){var e=[this._wrapped];return u.apply(e,arguments),N(this,i.apply(y,e))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];y.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0],N(this,i)}}),y.each(["concat","join","slice"],function(e){var t=o[e];y.prototype[e]=function(){return N(this,t.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof n&&n.amd&&n("underscore",[],function(){return y})}.call(this),function(e){var t="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"==typeof n&&n.amd)n("backbone",["underscore","jquery","exports"],function(i,s,n){t.Backbone=e(t,n,i,s)});else if("undefined"!=typeof exports){var i,r=s("underscore");try{i=s("jquery")}catch(a){}e(t,exports,r,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,i,s){var n=e.Backbone,r=Array.prototype.slice;t.VERSION="1.2.3",t.$=s,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=function(e,t,s){switch(e){case 1:return function(){return i[t](this[s])};case 2:return function(e){return i[t](this[s],e)};case 3:return function(e,n){return i[t](this[s],l(e,this),n)};case 4:return function(e,n,r){return i[t](this[s],l(e,this),n,r)};default:return function(){var e=r.call(arguments);return e.unshift(this[s]),i[t].apply(i,e)}}},o=function(e,t,s){i.each(t,function(t,n){i[n]&&(e.prototype[n]=a(t,n,s))})},l=function(e,t){return i.isFunction(e)?e:i.isObject(e)&&!t._isModel(e)?c(e):i.isString(e)?function(t){return t.get(e)}:e},c=function(e){var t=i.matches(e);return function(e){return t(e.attributes)}},u=t.Events={},h=/\s+/,d=function(e,t,s,n,r){var a,o=0;if(s&&"object"==typeof s){void 0!==n&&"context"in r&&void 0===r.context&&(r.context=n);for(a=i.keys(s);o<a.length;o++)t=d(e,t,a[o],s[a[o]],r)}else if(s&&h.test(s))for(a=s.split(h);o<a.length;o++)t=e(t,a[o],n,r);else t=e(t,s,n,r);return t};u.on=function(e,t,i){return p(this,e,t,i)};var p=function(e,t,i,s,n){if(e._events=d(f,e._events||{},t,i,{context:s,ctx:e,listening:n}),n){var r=e._listeners||(e._listeners={});r[n.id]=n}return e};u.listenTo=function(e,t,s){if(!e)return this;var n=e._listenId||(e._listenId=i.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),a=r[n];if(!a){var o=this._listenId||(this._listenId=i.uniqueId("l"));a=r[n]={obj:e,objId:n,id:o,listeningTo:r,count:0}}return p(e,t,s,this,a),this};var f=function(e,t,i,s){if(i){var n=e[t]||(e[t]=[]),r=s.context,a=s.ctx,o=s.listening;o&&o.count++,n.push({callback:i,context:r,ctx:r||a,listening:o})}return e};u.off=function(e,t,i){return this._events?(this._events=d(m,this._events,e,t,{context:i,listeners:this._listeners}),this):this},u.stopListening=function(e,t,s){var n=this._listeningTo;if(!n)return this;for(var r=e?[e._listenId]:i.keys(n),a=0;a<r.length;a++){var o=n[r[a]];if(!o)break;o.obj.off(t,s,this)}return i.isEmpty(n)&&(this._listeningTo=void 0),this};var m=function(e,t,s,n){if(e){var r,a=0,o=n.context,l=n.listeners;if(t||s||o){for(var c=t?[t]:i.keys(e);a<c.length;a++){t=c[a];var u=e[t];if(!u)break;for(var h=[],d=0;d<u.length;d++){var p=u[d];s&&s!==p.callback&&s!==p.callback._callback||o&&o!==p.context?h.push(p):(r=p.listening,r&&0===--r.count&&(delete l[r.id],delete r.listeningTo[r.objId]))}h.length?e[t]=h:delete e[t]}return i.size(e)?e:void 0}for(var f=i.keys(l);a<f.length;a++)r=l[f[a]],delete l[r.id],delete r.listeningTo[r.objId]}};u.once=function(e,t,s){var n=d(g,{},e,t,i.bind(this.off,this));return this.on(n,void 0,s)},u.listenToOnce=function(e,t,s){var n=d(g,{},t,s,i.bind(this.stopListening,this,e));return this.listenTo(e,n)};var g=function(e,t,s,n){if(s){var r=e[t]=i.once(function(){n(t,r),s.apply(this,arguments)});r._callback=s}return e};u.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),i=Array(t),s=0;t>s;s++)i[s]=arguments[s+1];return d(v,this._events,e,void 0,i),this};var v=function(e,t,i,s){if(e){var n=e[t],r=e.all;n&&r&&(r=r.slice()),n&&b(n,s),r&&b(r,[t].concat(s))}return e},b=function(e,t){var i,s=-1,n=e.length,r=t[0],a=t[1],o=t[2];switch(t.length){case 0:for(;++s<n;)(i=e[s]).callback.call(i.ctx);return;case 1:for(;++s<n;)(i=e[s]).callback.call(i.ctx,r);return;case 2:for(;++s<n;)(i=e[s]).callback.call(i.ctx,r,a);return;case 3:for(;++s<n;)(i=e[s]).callback.call(i.ctx,r,a,o);return;default:for(;++s<n;)(i=e[s]).callback.apply(i.ctx,t);return}};u.bind=u.on,u.unbind=u.off,i.extend(t,u);var y=t.Model=function(e,t){var s=e||{};t||(t={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(s=this.parse(s,t)||{}),s=i.defaults({},s,i.result(this,"defaults")),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(y.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!i.iteratee(e,this)(this.attributes)},set:function(e,t,s){if(null==e)return this;var n;if("object"==typeof e?(n=e,s=t):(n={})[e]=t,s||(s={}),!this._validate(n,s))return!1;var r=s.unset,a=s.silent,o=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var d in n)t=n[d],i.isEqual(c[d],t)||o.push(d),i.isEqual(h[d],t)?delete u[d]:u[d]=t,r?delete c[d]:c[d]=t;if(this.id=this.get(this.idAttribute),!a){o.length&&(this._pending=s);for(var p=0;p<o.length;p++)this.trigger("change:"+o[p],this,c[o[p]],s)}if(l)return this;if(!a)for(;this._pending;)s=this._pending,this._pending=!1,this.trigger("change",this,s);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var s in this.attributes)t[s]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,s={};for(var n in e){var r=e[n];i.isEqual(t[n],r)||(s[n]=r)}return i.size(s)?s:!1},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=i.extend({parse:!0},e);var t=this,s=e.success;return e.success=function(i){var n=e.parse?t.parse(i,e):i;return t.set(n,e)?(s&&s.call(e.context,t,i,e),void t.trigger("sync",t,i,e)):!1},H(this,e),this.sync("read",this,e)},save:function(e,t,s){var n;null==e||"object"==typeof e?(n=e,s=t):(n={})[e]=t,s=i.extend({validate:!0,parse:!0},s);var r=s.wait;if(n&&!r){if(!this.set(n,s))return!1}else if(!this._validate(n,s))return!1;var a=this,o=s.success,l=this.attributes;s.success=function(e){a.attributes=l;var t=s.parse?a.parse(e,s):e;return r&&(t=i.extend({},n,t)),t&&!a.set(t,s)?!1:(o&&o.call(s.context,a,e,s),void a.trigger("sync",a,e,s))},H(this,s),n&&r&&(this.attributes=i.extend({},l,n));var c=this.isNew()?"create":s.patch?"patch":"update";"patch"!==c||s.attrs||(s.attrs=n);var u=this.sync(c,this,s);return this.attributes=l,u},destroy:function(e){e=e?i.clone(e):{};var t=this,s=e.success,n=e.wait,r=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(i){n&&r(),s&&s.call(e.context,t,i,e),t.isNew()||t.trigger("sync",t,i,e)};var a=!1;return this.isNew()?i.defer(e.success):(H(this,e),a=this.sync("delete",this,e)),n||r(),a},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||R();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var s=this.validationError=this.validate(e,t)||null;return s?(this.trigger("invalid",this,s,i.extend(t,{validationError:s})),!1):!0}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};o(y,w,"attributes");var x=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},k={add:!0,remove:!0,merge:!0},S={add:!0,remove:!1},C=function(e,t,i){i=Math.min(Math.max(i,0),e.length);for(var s=Array(e.length-i),n=t.length,r=0;r<s.length;r++)s[r]=e[r+i];for(r=0;n>r;r++)e[r+i]=t[r];for(r=0;r<s.length;r++)e[r+n+i]=s[r]};i.extend(x.prototype,u,{model:y,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,S))},remove:function(e,t){t=i.extend({},t);var s=!i.isArray(e);e=s?[e]:i.clone(e);var n=this._removeModels(e,t);return!t.silent&&n&&this.trigger("update",this,t),s?n[0]:n},set:function(e,t){if(null!=e){t=i.defaults({},t,k),t.parse&&!this._isModel(e)&&(e=this.parse(e,t));var s=!i.isArray(e);e=s?[e]:e.slice();var n=t.at;null!=n&&(n=+n),0>n&&(n+=this.length+1);for(var r,a=[],o=[],l=[],c={},u=t.add,h=t.merge,d=t.remove,p=!1,f=this.comparator&&null==n&&t.sort!==!1,m=i.isString(this.comparator)?this.comparator:null,g=0;g<e.length;g++){r=e[g];var v=this.get(r);if(v){if(h&&r!==v){var b=this._isModel(r)?r.attributes:r;t.parse&&(b=v.parse(b,t)),v.set(b,t),f&&!p&&(p=v.hasChanged(m))}c[v.cid]||(c[v.cid]=!0,a.push(v)),e[g]=v}else u&&(r=e[g]=this._prepareModel(r,t),r&&(o.push(r),this._addReference(r,t),c[r.cid]=!0,a.push(r)))}if(d){for(g=0;g<this.length;g++)r=this.models[g],c[r.cid]||l.push(r);l.length&&this._removeModels(l,t)}var y=!1,w=!f&&u&&d;if(a.length&&w?(y=this.length!=a.length||i.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,C(this.models,a,0),this.length=this.models.length):o.length&&(f&&(p=!0),C(this.models,o,null==n?this.length:n),this.length=this.models.length),p&&this.sort({silent:!0}),!t.silent){for(g=0;g<o.length;g++)null!=n&&(t.index=n+g),r=o[g],r.trigger("add",r,this,t);(p||y)&&this.trigger("sort",this,t),(o.length||l.length)&&this.trigger("update",this,t)}return s?e[0]:e}},reset:function(e,t){t=t?i.clone(t):{};for(var s=0;s<this.models.length;s++)this._removeReference(this.models[s],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return r.apply(this.models,arguments)},get:function(e){if(null!=e){var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]}},at:function(e){return 0>e&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var s=t.length;return i.isFunction(t)&&(t=i.bind(t,this)),1===s||i.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=i.extend({parse:!0},e);var t=e.success,s=this;return e.success=function(i){var n=e.reset?"reset":"set";s[n](i,e),t&&t.call(e.context,s,i,e),s.trigger("sync",s,i,e)},H(this,e),this.sync("read",this,e)},create:function(e,t){t=t?i.clone(t):{};var s=t.wait;if(e=this._prepareModel(e,t),!e)return!1;s||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,i){s&&n.add(e,i),r&&r.call(i.context,e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?i.clone(t):{},t.collection=this;var s=new this.model(e,t);return s.validationError?(this.trigger("invalid",this,s.validationError,t),!1):s},_removeModels:function(e,t){for(var i=[],s=0;s<e.length;s++){var n=this.get(e[s]);if(n){var r=this.indexOf(n);this.models.splice(r,1),this.length--,t.silent||(t.index=r,n.trigger("remove",n,this,t)),i.push(n),this._removeReference(n,t)}}return i.length?i:!1},_isModel:function(e){return e instanceof y},_addReference:function(e,t){this._byId[e.cid]=e;var i=this.modelId(e.attributes);null!=i&&(this._byId[i]=e),e.on("all",this._onModelEvent,this);
},_removeReference:function(e,t){delete this._byId[e.cid];var i=this.modelId(e.attributes);null!=i&&delete this._byId[i],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,s){if("add"!==e&&"remove"!==e||i===this){if("destroy"===e&&this.remove(t,s),"change"===e){var n=this.modelId(t.previousAttributes()),r=this.modelId(t.attributes);n!==r&&(null!=n&&delete this._byId[n],null!=r&&(this._byId[r]=t))}this.trigger.apply(this,arguments)}}});var I={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};o(x,I,"models");var $=t.View=function(e){this.cid=i.uniqueId("view"),i.extend(this,i.pick(e,A)),this._ensureElement(),this.initialize.apply(this,arguments)},E=/^(\S+)\s*(.*)$/,A=["model","collection","el","id","attributes","className","tagName","events"];i.extend($.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=i.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var s=e[t];if(i.isFunction(s)||(s=this[s]),s){var n=t.match(E);this.delegate(n[1],n[2],i.bind(s,this))}}return this},delegate:function(e,t,i){return this.$el.on(e+".delegateEvents"+this.cid,t,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,i){return this.$el.off(e+".delegateEvents"+this.cid,t,i),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,s,n){var r=P[e];i.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:r,dataType:"json"};if(n.url||(a.url=i.result(s,"url")||R()),null!=n.data||!s||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(n.attrs||s.toJSON(n))),n.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),n.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",n.emulateJSON&&(a.data._method=r);var o=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}"GET"===a.type||n.emulateJSON||(a.processData=!1);var l=n.error;n.error=function(e,t,i){n.textStatus=t,n.errorThrown=i,l&&l.call(n.context,e,t,i)};var c=n.xhr=t.ajax(i.extend(a,n));return s.trigger("request",s,c,n),c};var P={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var M=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},O=/\((.*?)\)/g,j=/(\(\?)?:\w+/g,_=/\*\w+/g,T=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(M.prototype,u,{initialize:function(){},route:function(e,s,n){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(s)&&(n=s,s=""),n||(n=this[s]);var r=this;return t.history.route(e,function(i){var a=r._extractParameters(e,i);r.execute(n,a,s)!==!1&&(r.trigger.apply(r,["route:"+s].concat(a)),r.trigger("route",s,a),t.history.trigger("route",r,s,a))}),this},execute:function(e,t,i){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(T,"\\$&").replace(O,"(?:$1)?").replace(j,function(e,t){return t?e:"([^/?]+)"}).replace(_,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var s=e.exec(t).slice(1);return i.map(s,function(e,t){return t===s.length-1?e||null:e?decodeURIComponent(e):null})}});var z=t.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},L=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,q=/#.*$/;z.started=!1,i.extend(z.prototype,u,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(L,"")},start:function(e){if(z.started)throw new Error("Backbone.history has already been started");if(z.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(D,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var s=document.body,n=s.insertBefore(this.iframe,s.firstChild).contentWindow;n.document.open(),n.document.close(),n.location.hash="#"+this.fragment}var r=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};return this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),z.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),i.some(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})):!1},navigate:function(e,t){if(!z.started)return!1;t&&t!==!0||(t={trigger:!!t}),e=this.getFragment(e||"");var i=this.root;(""===e||"?"===e.charAt(0))&&(i=i.slice(0,-1)||"/");var s=i+e;if(e=this.decodeFragment(e.replace(q,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,s);else{if(!this._wantsHashChange)return this.location.assign(s);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var n=this.iframe.contentWindow;t.replace||(n.document.open(),n.document.close()),this._updateHash(n.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var s=e.href.replace(/(javascript:|#).*$/,"");e.replace(s+"#"+t)}else e.hash="#"+t}}),t.history=new z;var U=function(e,t){var s,n=this;s=e&&i.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},i.extend(s,n,t);var r=function(){this.constructor=s};return r.prototype=n.prototype,s.prototype=new r,e&&i.extend(s.prototype,e),s.__super__=n.prototype,s};y.extend=x.extend=M.extend=$.extend=z.extend=U;var R=function(){throw new Error('A "url" property or function must be specified')},H=function(e,t){var i=t.error;t.error=function(s){i&&i.call(t.context,e,s,t),e.trigger("error",e,s,t)}};return t}),n("ev-script/models/video-settings",["backbone"],function(e){"use strict";return e.Model.extend({defaults:{type:"video",width:"640",height:"360",showtitle:!0,autoplay:!1,showcaptions:!1,hidecontrols:!1,socialsharing:!1,annotations:!0,captionsearch:!0,attachments:!0,audiopreviewimage:!1,links:!0,metadata:!0,dateproduced:!0,embedcode:!1,download:!1,search:"",sourceId:"content",isaudio:!1}})}),n("ev-script/models/playlist-settings",["backbone"],function(e){"use strict";return e.Model.extend({defaults:{type:"playlist",width:"800",height:"1000",layout:"playlist",playlistLayout:{playlistSortBy:"videoDate",playlistSortDirection:"desc",playlistSearchString:"",playlistCategory:"",playlistNumberOfResults:""},showcaseLayout:{categoryList:!0,categoryOrientation:"horizontal"},embedcode:!1,statistics:!0,duration:!0,attachments:!0,annotations:!0,links:!0,credits:!0,socialsharing:!1,autoplay:!1,showcaptions:!1,dateproduced:!0,audiopreviewimage:!1,captionsearch:!0,search:""}})}),function(){"use strict";function e(e,t,i,s,n,r){t[e]&&(i.push(e),(t[e]===!0||1===t[e])&&s.push(n+e+"/"+r))}function t(e,t,i,n,r){var a=n+t+"/"+r;s._fileExists(e.toUrl(a+".js"))&&i.push(a)}function i(e,t,s){var n;for(n in t)!t.hasOwnProperty(n)||e.hasOwnProperty(n)&&!s?"object"==typeof t[n]&&(!e[n]&&t[n]&&(e[n]={}),i(e[n],t[n],s)):e[n]=t[n]}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;n("i18n",["module"],function(s){var n=s.config?s.config():{};return{version:"2.0.6",load:function(s,a,o,l){l=l||{},l.locale&&(n.locale=l.locale);var c,u,h,d=r.exec(s),p=d[1],f=d[4],m=d[5],g=f.split("-"),v=[],b={},y="";if(d[5]?(p=d[1],c=p+m):(c=s,m=d[4],f=n.locale,f||(f=n.locale="undefined"==typeof navigator?"root":(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage||"root").toLowerCase()),g=f.split("-")),l.isBuild){for(v.push(c),t(a,"root",v,p,m),u=0;u<g.length;u++)h=g[u],y+=(y?"-":"")+h,t(a,y,v,p,m);a(v,function(){o()})}else a([c],function(t){var s,n=[];for(e("root",t,n,v,p,m),u=0;u<g.length;u++)s=g[u],y+=(y?"-":"")+s,e(y,t,n,v,p,m);a(v,function(){var e,s,r;for(e=n.length-1;e>-1&&n[e];e--)r=n[e],s=t[r],(s===!0||1===s)&&(s=a(p+r+"/"+m)),i(b,s);o(b)})})}}})}(),n("ev-script/nls/messages",{root:!0,"es-mx":!0}),n("ev-script/nls/root/messages",{"%1$s Embed Options":"%1$s Embed Options","%1$s thumbnail image":"%1$s thumbnail image","Add %1$s":"Add %1$s","Add file":"Add file",Annotations:"Annotations","An unexpected error occurred.  Check the server log for more details.":"An unexpected error occurred.  Check the server log for more details.",Ascending:"Ascending",Attachments:"Attachments","Audio Preview Image":"Audio Preview Image","Auto Play":"Auto Play","Auto Play (PC Only)":"Auto Play (PC Only)",Cancel:"Cancel","Cancel upload":"Cancel upload","Caption Search":"Caption Search",'Captions "On" By Default':'Captions "On" By Default',Category:"Category","Category List":"Category List",CC:"CC","Change %1$s":"Change %1$s","Choose %1$s":"Choose %1$s",Choose:"Choose","Choose Layout":"Choose Layout","Content Details":"Content Details","Could not find requested resource.  This is likely a problem with the configured Ensemble Video base url.":"Could not find requested resource.  This is likely a problem with the configured Ensemble Video base url.",Credits:"Credits","Date Added":"Date Added","Date Produced":"Date Produced",Descending:"Descending",Description:"Description","Download Link":"Download Link","Drag file here.":"Drag file here.",Duration:"Duration","Embed Code":"Embed Code","Ensemble Logo":"Ensemble Logo","Ensemble Video Login":"Ensemble Video Login",Go:"Go","Hide Controls":"Hide Controls",Hide:"Hide","Hide Picker":"Hide Picker",Horizontal:"Horizontal","Identity Provider":"Identity Provider","It appears there is an issue with the Ensemble Video installation.":"It appears there is an issue with the Ensemble Video installation.",Keywords:"Keywords","Layout Options":"Layout Options",Less:"Less","Library:":"Library:",Library:"Library",Links:"Links","Loading...":"Loading...","Logout %1$s":"Logout %1$s",Logout:"Logout","Media Library":"Media Library",Media:"Media","Media thumbnail":"Media thumbnail","Meta Data":"Meta Data",More:"More",None:"None","No results available.":"No results available.","Number of Results":"Number of Results","Organization:":"Organization:",Original:"Original",Password:"Password",Playlist:"Playlist","Preview: %1$s":"Preview: %1$s","Preview:":"Preview:",Reload:"Reload","Remember Me":"Remember Me","Remove %1$s":"Remove %1$s",Save:"Save","Search Media":"Search Media","Search returned %1$s results.":"Search returned %1$s results.","Search:":"Search:","Search String":"Search String","Select Library":"Select Library","Select Library Type":"Select Library Type","Select Organization":"Select Organization","Shared Library":"Shared Library","Show Captions":"Show Captions",Showcase:"Showcase","Show Title":"Show Title",Size:"Size","Social Tools":"Social Tools","Sort By":"Sort By",Statistics:"Statistics",Submit:"Submit",Title:"Title","Type:":"Type:","Upload Media to Ensemble":"Upload Media to Ensemble",Upload:"Upload",Username:"Username",Vertical:"Vertical","You are unauthorized to access this content.":"You are unauthorized to access this content."}),!function(){"use strict";function e(e){return i(s(e),arguments)}function t(t,i){return e.apply(null,[t].concat(i||[]))}function i(t,i){var s,n,a,o,l,c,u,h,d,p=1,f=t.length,m="";for(n=0;f>n;n++)if("string"==typeof t[n])m+=t[n];else if(Array.isArray(t[n])){if(o=t[n],o[2])for(s=i[p],a=0;a<o[2].length;a++){if(!s.hasOwnProperty(o[2][a]))throw new Error(e('[sprintf] property "%s" does not exist',o[2][a]));s=s[o[2][a]]}else s=o[1]?i[o[1]]:i[p++];if(r.not_type.test(o[8])&&r.not_primitive.test(o[8])&&s instanceof Function&&(s=s()),r.numeric_arg.test(o[8])&&"number"!=typeof s&&isNaN(s))throw new TypeError(e("[sprintf] expecting number but found %T",s));switch(r.number.test(o[8])&&(h=s>=0),o[8]){case"b":s=parseInt(s,10).toString(2);break;case"c":s=String.fromCharCode(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,o[6]?parseInt(o[6]):0);break;case"e":s=o[7]?parseFloat(s).toExponential(o[7]):parseFloat(s).toExponential();break;case"f":s=o[7]?parseFloat(s).toFixed(o[7]):parseFloat(s);break;case"g":s=o[7]?String(Number(s.toPrecision(o[7]))):parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s=String(s),s=o[7]?s.substring(0,o[7]):s;break;case"t":s=String(!!s),s=o[7]?s.substring(0,o[7]):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=o[7]?s.substring(0,o[7]):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=o[7]?s.substring(0,o[7]):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase()}r.json.test(o[8])?m+=s:(!r.number.test(o[8])||h&&!o[3]?d="":(d=h?"+":"-",s=s.toString().replace(r.sign,"")),c=o[4]?"0"===o[4]?"0":o[4].charAt(1):" ",u=o[6]-(d+s).length,l=o[6]&&u>0?c.repeat(u):"",m+=o[5]?d+s+l:"0"===c?d+l+s:l+d+s)}return m}function s(e){if(a[e])return a[e];for(var t,i=e,s=[],n=0;i;){if(null!==(t=r.text.exec(i)))s.push(t[0]);else if(null!==(t=r.modulo.exec(i)))s.push("%");else{if(null===(t=r.placeholder.exec(i)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){n|=1;var o=[],l=t[2],c=[];if(null===(c=r.key.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o.push(c[1]);""!==(l=l.substring(c[0].length));)if(null!==(c=r.key_access.exec(l)))o.push(c[1]);else{if(null===(c=r.index_access.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(c[1])}t[2]=o}else n|=2;if(3===n)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");s.push(t)}i=i.substring(t[0].length)}return a[e]=s}var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/},a=Object.create(null);"undefined"!=typeof exports&&(exports.sprintf=e,exports.vsprintf=t),"undefined"!=typeof window&&(window.sprintf=e,window.vsprintf=t,"function"==typeof n&&n.amd&&n("sprintf",[],function(){return{sprintf:e,vsprintf:t}}))}(),n("ev-script/util/events",["require","underscore","backbone"],function(e){"use strict";var t=[],i=e("underscore"),s=e("backbone");return t.global=i.extend({},s.Events),{initEvents:function(e){return t[e]=i.extend({},s.Events)},getEvents:function(e){var i;return i=e?t[e]:t.global}}}),n("ev-script/util/cache",["require","jquery","underscore","backbone"],function(e){"use strict";var t=(e("jquery"),e("underscore"),e("backbone"),function(){return this.cache=[],this.get=function(e){return e?this.cache[e]:null},this.set=function(e,t){return e?this.cache[e]=t:null},this}),i=new t,s=function(e){var s=i.get(e);return s||(s=i.set(e,new t)),s},n=function(e,t){return s(e).set("config",t)},r=function(e){return s(e).get("config")},a=function(e,t){return s(e).set("auth",t)},o=function(e){return s(e).get("auth")},l=function(e,t){return s(e).set("info",t)},c=function(e){return s(e).get("info")},u=function(e,s){var n=i.get(e);n||(n=i.set(e,new t));var r=n.get(s);return r||(r=n.set(s,new t)),r};return{Cache:t,caches:i,setAppConfig:n,getAppConfig:r,setAppAuth:a,getAppAuth:o,setAppInfo:l,getAppInfo:c,getUserCache:u}}),n("ev-script/views/base",["require","jquery","underscore","backbone","ev-script/util/events","ev-script/util/cache","i18n!ev-script/nls/messages"],function(e){"use strict";var t=e("jquery"),i=(e("underscore"),e("backbone")),s=e("ev-script/util/events"),n=e("ev-script/util/cache"),r=e("i18n!ev-script/nls/messages");return i.View.extend({initialize:function(e){this.appId=e.appId,this.config=n.getAppConfig(this.appId),this.auth=n.getAppAuth(this.appId),this.info=n.getAppInfo(this.appId),this.appEvents=s.getEvents(this.appId),this.globalEvents=s.getEvents("global")},ajaxError:function(e,t){401===e.status?this.auth.handleUnauthorized(this.el,t):500===e.status?window.alert(r["It appears there is an issue with the Ensemble Video installation."]):404===e.status?window.alert(r["Could not find requested resource.  This is likely a problem with the configured Ensemble Video base url."]):0!==e.status&&window.alert(r["An unexpected error occurred.  Check the server log for more details."])},unencode:function(e){return t("<span/>").html(e).text()}})}),function(){"use strict";function e(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function t(e,t,i){var n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&i&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&i&&(e=e.replace(RegExp(t,"i"),i)),e=s(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function i(e,t){var i=-1,s=e?e.length:0;if("number"==typeof s&&s>-1&&b>=s)for(;++i<s;)t(e[i],i,e);else r(e,t)}function s(t){return t=u(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:e(t)}function r(e,t){for(var i in e)k.call(e,i)&&t(e[i],i,e)}function a(t){return null==t?e(t):S.call(t).slice(8,-1)}function o(e,t){var i=null!=e?typeof e[t]:"number";return!/^(?:boolean|number|string|undefined)$/.test(i)&&("object"==i?!!e[t]:!0)}function l(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function c(e,t){var s=null;return i(e,function(i,n){s=t(s,i,n,e)}),s}function u(e){return String(e).replace(/^ +| +$/g,"")}function h(e){function i(t){return c(t,function(t,i){return t||RegExp("\\b"+(i.pattern||l(i))+"\\b","i").exec(e)&&(i.label||i)})}function n(t){return c(t,function(t,i,s){return t||(i[K]||i[/^[a-z]+(?: +[a-z]+\b)*/i.exec(K)]||RegExp("\\b"+l(s)+"(?:\\b|\\w*\\d)","i").exec(e))&&s})}function d(t){return c(t,function(t,i){return t||RegExp("\\b"+(i.pattern||l(i))+"\\b","i").exec(e)&&(i.label||i)})}function m(i){return c(i,function(i,s){var n=s.pattern||l(s);return!i&&(i=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(i=t(i,n,s.label||s)),i})}function g(t){return c(t,function(t,i){var n=i.pattern||l(i);return!t&&(t=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+n+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(i.label&&!RegExp(n,"i").test(i.label)?i.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),i=i.label||i,t=s(t[0].replace(RegExp(n,"i"),i).replace(RegExp("; *(?:"+i+"[_-])?","i")," ").replace(RegExp("("+i+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function v(t){return c(t,function(t,i){return t||(RegExp(i+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}function b(){return this.description||""}var x=p,k=e&&"object"==typeof e&&"String"!=a(e);k&&(x=e,e=null);var C=x.navigator||{},I=C.userAgent||"";e||(e=I);var $,E,A=k||w==f,P=k?!!C.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(S.toString()),M="Object",O=k?M:"ScriptBridgingProxyObject",j=k?M:"Environment",_=k&&x.java?"JavaPackage":a(x.java),T=k?M:"RuntimeObject",z=/\bJava/.test(_)&&x.java,L=z&&a(x.environment)==j,D=z?"a":"",q=z?"b":"",U=x.document||{},R=x.operamini||x.opera,H=y.test(H=k&&R?R["[[Class]]"]:a(R))?H:R=null,N=e,W=[],V=null,F=e==I,B=F&&R&&"function"==typeof R.version&&R.version(),X=i([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),G=d(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),K=g([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),J=n({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),Q=m(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(X&&(X=[X]),J&&!K&&(K=g([J])),($=/\bGoogle TV\b/.exec(K))&&(K=$[0]),/\bSimulator\b/i.test(e)&&(K=(K?K+" ":"")+"Simulator"),"Opera Mini"==G&&/\bOPiOS\b/.test(e)&&W.push("running in Turbo/Uncompressed mode"),"IE"==G&&/\blike iPhone OS\b/.test(e)?($=h(e.replace(/like iPhone OS/,"")),J=$.manufacturer,K=$.product):/^iP/.test(K)?(G||(G="Safari"),Q="iOS"+(($=/ OS ([\d_]+)/i.exec(e))?" "+$[1].replace(/_/g,"."):"")):"Konqueror"!=G||/buntu/i.test(Q)?J&&"Google"!=J&&(/Chrome/.test(G)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(K))||/\bAndroid\b/.test(Q)&&/^Chrome/.test(G)&&/\bVersion\//i.test(e)?(G="Android Browser",Q=/\bAndroid\b/.test(Q)?Q:"Android"):"Silk"==G?(/\bMobi/i.test(e)||(Q="Android",W.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&W.unshift("accelerated")):"PaleMoon"==G&&($=/\bFirefox\/([\d.]+)\b/.exec(e))?W.push("identifying as Firefox "+$[1]):"Firefox"==G&&($=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(Q||(Q="Firefox OS"),K||(K=$[1])):!G||($=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(G))?(G&&!K&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf($+"/")+8))&&(G=null),($=K||J||Q)&&(K||J||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Q))&&(G=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Q)?Q:$)+" Browser")):"Electron"==G&&($=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&W.push("Chromium "+$):Q="Kubuntu",B||(B=v(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",l(G),"(?:Firefox|Minefield|NetFront)"])),($="iCab"==X&&parseFloat(B)>3&&"WebKit"||/\bOpera\b/.test(G)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(X)&&"WebKit"||!X&&/\bMSIE\b/i.test(e)&&("Mac OS"==Q?"Tasman":"Trident")||"WebKit"==X&&/\bPlayStation\b(?! Vita\b)/i.test(G)&&"NetFront")&&(X=[$]),"IE"==G&&($=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(G+=" Mobile",Q="Windows Phone "+(/\+$/.test($)?$:$+".x"),W.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(G="IE Mobile",Q="Windows Phone 8.x",W.unshift("desktop mode"),B||(B=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=G&&"Trident"==X&&($=/\brv:([\d.]+)/.exec(e))&&(G&&W.push("identifying as "+G+(B?" "+B:"")),G="IE",B=$[1]),F){if(o(x,"global"))if(z&&($=z.lang.System,N=$.getProperty("os.arch"),Q=Q||$.getProperty("os.name")+" "+$.getProperty("os.version")),A&&o(x,"system")&&($=[x.system])[0]){Q||(Q=$[0].os||null);try{$[1]=x.require("ringo/engine").version,B=$[1].join("."),G="RingoJS"}catch(Z){$[0].global.system==x.system&&(G="Narwhal")}}else"object"==typeof x.process&&!x.process.browser&&($=x.process)?"object"==typeof $.versions?"string"==typeof $.versions.electron?(W.push("Node "+$.versions.node),G="Electron",B=$.versions.electron):"string"==typeof $.versions.nw&&(W.push("Chromium "+B,"Node "+$.versions.node),G="NW.js",B=$.versions.nw):(G="Node.js",N=$.arch,Q=$.platform,B=/[\d.]+/.exec($.version),B=B?B[0]:"unknown"):L&&(G="Rhino");else a($=x.runtime)==O?(G="Adobe AIR",Q=$.flash.system.Capabilities.os):a($=x.phantom)==T?(G="PhantomJS",B=($=$.version||null)&&$.major+"."+$.minor+"."+$.patch):"number"==typeof U.documentMode&&($=/\bTrident\/(\d+)/i.exec(e))?(B=[B,U.documentMode],($=+$[1]+4)!=B[1]&&(W.push("IE "+B[1]+" mode"),X&&(X[1]=""),B[1]=$),B="IE"==G?String(B[1].toFixed(1)):B[0]):"number"==typeof U.documentMode&&/^(?:Chrome|Firefox)\b/.test(G)&&(W.push("masking as "+G+" "+B),G="IE",B="11.0",X=["Trident"],Q="Windows");Q=Q&&s(Q)}if(B&&($=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(B)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(F&&C.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(V=/b/i.test($)?"beta":"alpha",B=B.replace(RegExp($+"\\+?$"),"")+("beta"==V?q:D)+(/\d+\+?/.exec($)||"")),"Fennec"==G||"Firefox"==G&&/\b(?:Android|Firefox OS)\b/.test(Q))G="Firefox Mobile";else if("Maxthon"==G&&B)B=B.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(K))"Xbox 360"==K&&(Q=null),"Xbox 360"==K&&/\bIEMobile\b/.test(e)&&W.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(G)&&(!G||K||/Browser|Mobi/.test(G))||"Windows CE"!=Q&&!/Mobi/i.test(e))if("IE"==G&&F)try{null===x.external&&W.unshift("platform preview")}catch(Z){W.unshift("embedded")}else(/\bBlackBerry\b/.test(K)||/\bBB10\b/.test(e))&&($=(RegExp(K.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||B)?($=[$,/BB10/.test(e)],Q=($[1]?(K=null,J="BlackBerry"):"Device Software")+" "+$[0],B=null):this!=r&&"Wii"!=K&&(F&&R||/Opera/.test(G)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==G&&/\bOS X (?:\d+\.){2,}/.test(Q)||"IE"==G&&(Q&&!/^Win/.test(Q)&&B>5.5||/\bWindows XP\b/.test(Q)&&B>8||8==B&&!/\bTrident\b/.test(e)))&&!y.test($=h.call(r,e.replace(y,"")+";"))&&$.name&&($="ing as "+$.name+(($=$.version)?" "+$:""),y.test(G)?(/\bIE\b/.test($)&&"Mac OS"==Q&&(Q=null),$="identify"+$):($="mask"+$,G=H?s(H.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test($)&&(Q=null),F||(B=null)),X=["Presto"],W.push($));else G+=" Mobile";($=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&($=[parseFloat($.replace(/\.(\d)$/,".0$1")),$],"Safari"==G&&"+"==$[1].slice(-1)?(G="WebKit Nightly",V="alpha",B=$[1].slice(0,-1)):(B==$[1]||B==($[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1]))&&(B=null),$[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==$[0]&&537.36==$[2]&&parseFloat($[1])>=28&&"WebKit"==X&&(X=["Blink"]),F&&(P||$[1])?(X&&(X[1]="like Chrome"),$=$[1]||($=$[0],530>$?1:532>$?2:532.05>$?3:533>$?4:534.03>$?5:534.07>$?6:534.1>$?7:534.13>$?8:534.16>$?9:534.24>$?10:534.3>$?11:535.01>$?12:535.02>$?"13+":535.07>$?15:535.11>$?16:535.19>$?17:536.05>$?18:536.1>$?19:537.01>$?20:537.11>$?"21+":537.13>$?23:537.18>$?24:537.24>$?25:537.36>$?26:"Blink"!=X?"27":"28")):(X&&(X[1]="like Safari"),$=$[0],$=400>$?1:500>$?2:526>$?3:533>$?4:534>$?"4+":535>$?5:537>$?6:538>$?7:601>$?8:"8"),X&&(X[1]+=" "+($+="number"==typeof $?".x":/[.+]/.test($)?"":"+")),"Safari"==G&&(!B||parseInt(B)>45)&&(B=$)),"Opera"==G&&($=/\bzbov|zvav$/.exec(Q))?(G+=" ",W.unshift("desktop mode"),"zvav"==$?(G+="Mini",B=null):G+="Mobile",Q=Q.replace(RegExp(" *"+$+"$"),"")):"Safari"==G&&/\bChrome\b/.exec(X&&X[1])&&(W.unshift("desktop mode"),G="Chrome Mobile",B=null,/\bOS X\b/.test(Q)?(J="Apple",Q="iOS 4.3+"):Q=null),B&&0==B.indexOf($=/[\d.]+$/.exec(Q))&&e.indexOf("/"+$+"-")>-1&&(Q=u(Q.replace($,""))),X&&!/\b(?:Avant|Nook)\b/.test(G)&&(/Browser|Lunascape|Maxthon/.test(G)||"Safari"!=G&&/^iOS/.test(Q)&&/\bSafari\b/.test(X[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(G)&&X[1])&&($=X[X.length-1])&&W.push($),
W.length&&(W=["("+W.join("; ")+")"]),J&&K&&K.indexOf(J)<0&&W.push("on "+J),K&&W.push((/^on /.test(W[W.length-1])?"":"on ")+K),Q&&($=/ ([\d.+]+)$/.exec(Q),E=$&&"/"==Q.charAt(Q.length-$[0].length-1),Q={architecture:32,family:$&&!E?Q.replace($[0],""):Q,version:$?$[1]:null,toString:function(){var e=this.version;return this.family+(e&&!E?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),($=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(N))&&!/\bi686\b/i.test(N)?(Q&&(Q.architecture=64,Q.family=Q.family.replace(RegExp(" *"+$),"")),G&&(/\bWOW64\b/i.test(e)||F&&/\w(?:86|32)$/.test(C.cpuClass||C.platform)&&!/\bWin64; x64\b/i.test(e))&&W.unshift("32-bit")):Q&&/^OS X/.test(Q.family)&&"Chrome"==G&&parseFloat(B)>=39&&(Q.architecture=64),e||(e=null);var Y={};return Y.description=e,Y.layout=X&&X[0],Y.manufacturer=J,Y.name=G,Y.prerelease=V,Y.product=K,Y.ua=e,Y.version=G&&B,Y.os=Q||{architecture:null,family:null,version:null,toString:function(){return"null"}},Y.parse=h,Y.toString=b,Y.version&&W.unshift(B),Y.name&&W.unshift(G),Q&&G&&(Q!=String(Q).split(" ")[0]||Q!=G.split(" ")[0]&&!K)&&W.push(K?"("+Q+")":"on "+Q),W.length&&(Y.description=W.join(" ")),Y}var d={"function":!0,object:!0},p=d[typeof window]&&window||this,f=p,m=d[typeof exports]&&exports,g=d[typeof module]&&module&&!module.nodeType&&module,v=m&&g&&"object"==typeof global&&global;!v||v.global!==v&&v.window!==v&&v.self!==v||(p=v);var b=Math.pow(2,53)-1,y=/\bOpera/,w=this,x=Object.prototype,k=x.hasOwnProperty,S=x.toString,C=h();"function"==typeof n&&"object"==typeof n.amd&&n.amd?(p.platform=C,n("platform",[],function(){return C})):m&&g?r(C,function(e,t){m[t]=e}):p.platform=C}.call(this),n("text",["module"],function(e){"use strict";function t(e,t){return void 0===e||""===e?t:e}function i(e,i,s,n){if(i===n)return!0;if(e===s){if("http"===e)return t(i,"80")===t(n,"80");if("https"===e)return t(i,"443")===t(n,"443")}return!1}var n,r,a,o,l,c=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,p=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,m=d&&(location.port||void 0),g={},v=e.config&&e.config()||{};return n={version:"2.0.15",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(h);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:v.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=c[t];try{e=new ActiveXObject(i)}catch(s){}if(e){c=[i];break}}return e},parseName:function(e){var t,i,s,n=!1,r=e.lastIndexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!a||r>1)?(t=e.substring(0,r),i=e.substring(r+1)):t=e,s=i||t,r=s.indexOf("!"),-1!==r&&(n="strip"===s.substring(r+1),s=s.substring(0,r),i?i=s:t=s),{moduleName:t,ext:i,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,s,r){var a,o,l,c=n.xdRegExp.exec(e);return c?(a=c[2],o=c[3],o=o.split(":"),l=o[1],o=o[0],(!a||a===t)&&(!o||o.toLowerCase()===s.toLowerCase())&&(!l&&!o||i(a,l,t,r))):!0},finishLoad:function(e,t,i,s){i=t?n.strip(i):i,v.isBuild&&(g[e]=i),s(i)},load:function(e,t,i,s){if(s&&s.isBuild&&!s.inlineText)return void i();v.isBuild=s&&s.isBuild;var r=n.parseName(e),a=r.moduleName+(r.ext?"."+r.ext:""),o=t.toUrl(a),l=v.useXhr||n.useXhr;return 0===o.indexOf("empty:")?void i():void(!d||l(o,p,f,m)?n.get(o,function(t){n.finishLoad(e,r.strip,t,i)},function(e){i.error&&i.error(e)}):t([a],function(e){n.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)}))},write:function(e,t,i,s){if(g.hasOwnProperty(t)){var r=n.jsEscape(g[t]);i.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,i,s,r){var a=n.parseName(t),o=a.ext?"."+a.ext:"",l=a.moduleName+o,c=i.toUrl(a.moduleName+o)+".js";n.load(l,i,function(t){var i=function(e){return s(c,e)};i.asModule=function(e,t){return s.asModule(e,c,t)},n.write(e,l,i,r)},r)}},"node"===v.env||!v.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(r=s.nodeRequire("fs"),n.get=function(e,t,i){try{var s=r.readFileSync(e,"utf8");"\ufeff"===s[0]&&(s=s.substring(1)),t(s)}catch(n){i&&i(n)}}):"xhr"===v.env||!v.env&&n.createXhr()?n.get=function(e,t,i,s){var r,a=n.createXhr();if(a.open("GET",e,!0),s)for(r in s)s.hasOwnProperty(r)&&a.setRequestHeader(r.toLowerCase(),s[r]);v.onXhr&&v.onXhr(a,e),a.onreadystatechange=function(s){var n,r;4===a.readyState&&(n=a.status||0,n>399&&600>n?(r=new Error(e+" HTTP status: "+n),r.xhr=a,i&&i(r)):t(a.responseText),v.onXhrComplete&&v.onXhrComplete(a,e))},a.send(null)}:"rhino"===v.env||!v.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(e,t){var i,s,n="utf-8",r=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),l="";try{for(i=new java.lang.StringBuffer,s=o.readLine(),s&&s.length()&&65279===s.charAt(0)&&(s=s.substring(1)),null!==s&&i.append(s);null!==(s=o.readLine());)i.append(a),i.append(s);l=String(i.toString())}finally{o.close()}t(l)}:("xpconnect"===v.env||!v.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(a=Components.classes,o=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),l="@mozilla.org/windows-registry-key;1"in a,n.get=function(e,t){var i,s,n,r={};l&&(e=e.replace(/\//g,"\\")),n=new FileUtils.File(e);try{i=a["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),i.init(n,1,0,!1),s=a["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),s.init(i,"utf-8",i.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(i.available(),r),s.close(),i.close(),t(r.value)}catch(c){throw new Error((n&&n.path||"")+": "+c)}}),n}),n("text!ev-script/templates/hider.html",[],function(){return'<a class="action-hide" href="#" title="<%= messages[\'Hide Picker\'] %>"><%= messages[\'Hide\'] %></a>\n<% if (showLogout) { %>\n    <a class="action-logout" href="#" title="<%= sprintf(messages[\'Logout %1$s\'], username) %>"><%= messages[\'Logout\'] %></a>\n<% } %>\n'}),n("ev-script/views/hider",["require","underscore","i18n!ev-script/nls/messages","sprintf","ev-script/views/base","text!ev-script/templates/hider.html"],function(e){"use strict";var t=e("underscore"),i=e("i18n!ev-script/nls/messages"),s=e("sprintf"),n=e("ev-script/views/base");return n.extend({template:t.template(e("text!ev-script/templates/hider.html")),initialize:function(e){n.prototype.initialize.call(this,e),t.bindAll(this,"hideHandler","logoutHandler","authHandler","render"),this.globalEvents.on("loggedIn",this.authHandler),this.globalEvents.on("loggedOut",this.authHandler),this.field=e.field},events:{"click a.action-hide":"hideHandler","click a.action-logout":"logoutHandler"},authHandler:function(e){e===this.config.ensembleUrl&&this.render()},render:function(){var e="";this.info.get("ApplicationVersion")&&this.auth.isAuthenticated()&&(e=this.auth.getUser().get("UserName")),this.$el.html(this.template({messages:i,sprintf:s.sprintf,showLogout:this.auth.isAuthenticated()&&"none"!==this.config.authType,username:e}))},hideHandler:function(e){this.appEvents.trigger("hidePicker",this.field.id),e.preventDefault()},logoutHandler:function(e){this.auth.logout().always(this.appEvents.trigger("hidePickers")),e.preventDefault()}})}),n("text!ev-script/templates/picker.html",[],function(){return'<div id="<%= id %>-hider" class="ev-hider"></div>\n<div id="<%= id %>-filter-block" class="ev-filter-block">\n    <div class="loader"></div>\n</div>\n<div id="<%= id %>-results" class="ev-results clearfix"></div>\n<div id="anthemContainer"></div>\n'}),n("ev-script/views/picker",["require","jquery","underscore","ev-script/views/base","ev-script/views/hider","text!ev-script/templates/picker.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("ev-script/views/base"),n=e("ev-script/views/hider");return s.extend({template:i.template(e("text!ev-script/templates/picker.html")),initialize:function(e){s.prototype.initialize.call(this,e),i.bindAll(this,"chooseItem","hidePicker","showPicker","setHeight","resizeResults"),this.$el.hide(),this.$el.html(this.template({id:this.id})),this.field=e.field,this.hider=new n({el:this.$("div.ev-hider"),field:this.field,appId:this.appId});var r=this.$("div.loader");t(window.document).on("ajaxSend",i.bind(function(e,t,i){this===i.picker&&r.addClass("loading")},this)).on("ajaxComplete",i.bind(function(e,t,i){this===i.picker&&r.removeClass("loading")},this)),this.appEvents.on("hidePickers",function(e){e&&this.field.id===e||this.hidePicker()},this),this.appEvents.on("showPicker",function(e){this.field.id===e&&this.$el.is(":hidden")&&this.showPicker()},this),this.appEvents.on("hidePicker",function(e){this.field.id===e&&this.hidePicker()},this),this.hider.render()},chooseItem:function(e){var i=t(e.currentTarget).attr("rel"),s=this.resultsView.collection.get(i);this.model.set({id:i,content:s.toJSON()}),this.field.model.set(this.model.attributes),this.appEvents.trigger("hidePicker",this.field.id),e.preventDefault()},hidePicker:function(){this.$el.hide()},showPicker:function(){this.hider.render(),this.$el.show()},setHeight:function(e){this.$el.height(e),this.resizeResults()},resizeResults:function(){}})}),n("text!ev-script/templates/search.html",[],function(){return'<label for="<%= id %>"><%= messages[\'Search:\'] %></label>\n<input id="<%= id %>" type="search" class="form-text search" value="<%- searchVal %>" title="<%= messages[\'Search Media\'] %>" />\n<input type="submit" value="<%= messages[\'Go\'] %>" class="form-submit" />\n'}),n("ev-script/views/search",["require","underscore","i18n!ev-script/nls/messages","ev-script/views/base","text!ev-script/templates/search.html"],function(e){"use strict";var t=e("underscore"),i=e("i18n!ev-script/nls/messages"),s=e("ev-script/views/base");return s.extend({template:t.template(e("text!ev-script/templates/search.html")),initialize:function(e){s.prototype.initialize.call(this,e),t.bindAll(this,"searchHandler","doSearch","autoSearch"),this.picker=e.picker,this.callback=e.callback||function(){}},events:{"keydown .search":"searchHandler","keyup .search":"autoSearch"},render:function(){this.$el.html(this.template({messages:i,id:this.id+"-input",searchVal:this.picker.model.get("search")}))},doSearch:function(){this.picker.model.set({search:this.$(".search").val()}),this.callback()},searchHandler:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&(this.submitTimeout&&clearTimeout(this.submitTimeout),this.doSearch(),e.preventDefault())},autoSearch:function(e){var i=e.target.value;i!==this.lastValue&&(this.lastValue=i,this.submitTimeout&&clearTimeout(this.submitTimeout),this.submitTimeout=setTimeout(t.bind(function(){this.doSearch()},this),1e3))}})}),n("text!ev-script/templates/library-type-select.html",[],function(){return'<div>\n  <label for="<%= id %>"><%= messages[\'Type:\'] %></label>\n  <select id="<%= id %>" class="form-select source" title="<%= messages[\'Select Library Type\'] %>">\n    <option value="content" <% if (sourceId === \'content\') { print(\'selected="selected"\'); } %>><%= messages[\'Media Library\'] %></option>\n    <option value="shared" <% if (sourceId === \'shared\') { print(\'selected="selected"\'); } %>><%= messages[\'Shared Library\'] %></option>\n  </select>\n  <input type="submit" value="<%= messages[\'Go\'] %>" class="form-submit" />\n</div>\n'}),n("ev-script/views/library-type-select",["require","underscore","i18n!ev-script/nls/messages","ev-script/views/base","text!ev-script/templates/library-type-select.html"],function(e){"use strict";var t=e("underscore"),i=e("i18n!ev-script/nls/messages"),s=e("ev-script/views/base");return s.extend({template:t.template(e("text!ev-script/templates/library-type-select.html")),initialize:function(e){s.prototype.initialize.call(this,e),t.bindAll(this,"changeHandler"),this.picker=e.picker,this.callback=e.callback||function(){}},events:{"change .source":"changeHandler"},render:function(){this.$el.html(this.template({messages:i,id:this.id+"-select",sourceId:this.picker.model.get("sourceId")}))},changeHandler:function(e){this.picker.model.set({sourceId:this.$(".source").val()}),this.callback(),e.preventDefault()}})}),n("text!ev-script/templates/options.html",[],function(){return"<% collection.each(function(item) { %>\n    <option value=\"<%= item.id %>\" <% if (selectedId === item.id) { print('selected=\"selected\"'); } %>><%- item.get('Name') %></option>\n<% }); %>\n"}),n("ev-script/views/organization-select",["require","underscore","ev-script/views/base","text!ev-script/templates/options.html"],function(e){"use strict";var t=e("underscore"),i=e("ev-script/views/base");return i.extend({template:t.template(e("text!ev-script/templates/options.html")),initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"render"),this.picker=e.picker,this.$el.html('<option value="-1">Loading...</option>'),this.collection.on("reset",this.render)},render:function(){var e=this.picker.model.get("organizationId")||this.auth.getUser().get("OrganizationID");this.$el.html(this.template({selectedId:e,collection:this.collection})),this.$el.trigger("change")}})}),n("ev-script/collections/base",["require","jquery","underscore","backbone","ev-script/util/cache"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("backbone"),n=e("ev-script/util/cache");return s.Collection.extend({initialize:function(e,t){this.requiresAuth=!0,this.appId=t.appId,this.config=n.getAppConfig(this.appId),this.auth=n.getAppAuth(this.appId),this.info=n.getAppInfo(this.appId)},model:s.Model.extend({idAttribute:"ID"}),getCached:function(e){},setCached:function(e,t){},clearCache:function(e){},parse:function(e){return e.Data},fetch:function(e){return e&&e.success&&(e.success=i.wrap(e.success,i.bind(function(e){var t=Array.prototype.slice.call(arguments,1);this.requiresAuth&&!this.auth.isAuthenticated()?this.auth.fetchUser().always(function(){e.apply(this,t)}):e.apply(this,t)},this))),s.Collection.prototype.fetch.call(this,e)},sync:function(e,n,r){if(i.defaults(r||(r={}),{xhrFields:{withCredentials:!0}}),"read"===e){var a=this.getCached(r.cacheKey);if(a){var o=t.Deferred();return r.success&&o.done(r.success),o.resolve(a).promise()}return r.success=r.success||function(e,t,i){},r.success=i.wrap(r.success,i.bind(function(e){this.setCached(r.cacheKey,arguments[1]),e.apply(this,Array.prototype.slice.call(arguments,1))},this)),s.Collection.prototype.sync.call(this,e,n,r)}return s.Collection.prototype.sync.call(this,e,n,r)}})}),n("ev-script/collections/organizations",["require","ev-script/collections/base","ev-script/util/cache"],function(e){"use strict";var t=e("ev-script/collections/base"),i=e("ev-script/util/cache");return t.extend({initialize:function(e,i){t.prototype.initialize.call(this,e,i)},_cache:function(e,t){var s=this.auth.getUser(),n=s?i.getUserCache(this.config.ensembleUrl,s.id):null;return n?n[t?"set":"get"](e,t):null},getCached:function(e){return this._cache("orgs")},setCached:function(e,t){return this._cache("orgs",t)},url:function(){var e=this.config.ensembleUrl+"/api/Organizations",t="PageSize=9999",i="PageIndex=1",s=e+"?"+t+"&"+i;return this.config.urlCallback?this.config.urlCallback(s):s}})}),n("ev-script/views/library-select",["require","underscore","i18n!ev-script/nls/messages","ev-script/views/base","text!ev-script/templates/options.html"],function(e){"use strict";var t=e("underscore"),i=e("i18n!ev-script/nls/messages"),s=e("ev-script/views/base");return s.extend({template:t.template(e("text!ev-script/templates/options.html")),initialize:function(e){s.prototype.initialize.call(this,e),t.bindAll(this,"render"),this.picker=e.picker,this.$el.html('<option value="-1">'+i["Loading..."]+"</option>"),this.collection.on("reset",this.render)},render:function(){var e=this.picker.model.get("libraryId")||this.auth.getUser().get("LibraryID");this.$el.html(this.template({selectedId:e,collection:this.collection})),this.$el.trigger("change")}})}),n("ev-script/collections/libraries",["require","ev-script/collections/base","ev-script/util/cache"],function(e){"use strict";var t=e("ev-script/collections/base"),i=e("ev-script/util/cache");return t.extend({initialize:function(e,i){t.prototype.initialize.call(this,e,i),this.filterValue=i.organizationId||""},_cache:function(e,t){var s=null,n=this.auth.getUser(),r=n?i.getUserCache(this.config.ensembleUrl,n.id):null;if(r){var a=r.get("libs");a||r.set("libs",a=new i.Cache),s=a[t?"set":"get"](e,t)}return s},getCached:function(e){return this._cache(e)},setCached:function(e,t){return this._cache(e,t)},url:function(){var e=this.config.ensembleUrl+"/api/Libraries",t="PageSize=9999",i="PageIndex=1",s="FilterOn=OrganizationId",n="FilterValue="+encodeURIComponent(this.filterValue),r=e+"?"+t+"&"+i+"&"+s+"&"+n;return this.config.urlCallback?this.config.urlCallback(r):r}})}),n("text!ev-script/templates/unit-selects.html",[],function(){return'<div id="<%= formId %>" class="unit-selects">\n    <label for="<%= orgSelectId %>"><%= messages[\'Organization:\'] %></label><select id="<%= orgSelectId %>" class="form-select organizations" title="<%= messages[\'Select Organization\'] %>"></select><label for="<%= libSelectId %>"><%= messages[\'Library:\'] %></label><select id="<%= libSelectId %>" class="form-select libraries" title="<%= messages[\'Select Library\'] %>"></select><input type="submit" value="<%= messages[\'Go\'] %>" class="form-submit" />\n</div>\n'}),n("ev-script/views/unit-selects",["require","jquery","underscore","i18n!ev-script/nls/messages","ev-script/views/base","ev-script/views/organization-select","ev-script/collections/organizations","ev-script/views/library-select","ev-script/collections/libraries","text!ev-script/templates/unit-selects.html"],function(e){"use strict";var t=(e("jquery"),e("underscore")),i=e("i18n!ev-script/nls/messages"),s=e("ev-script/views/base"),n=e("ev-script/views/organization-select"),r=e("ev-script/collections/organizations"),a=e("ev-script/views/library-select"),o=e("ev-script/collections/libraries");return s.extend({template:t.template(e("text!ev-script/templates/unit-selects.html")),initialize:function(e){s.prototype.initialize.call(this,e),t.bindAll(this,"loadOrgs","loadLibraries","changeOrganization","changeLibrary"),this.picker=e.picker,this.id=e.id,this.$el.html(this.template({messages:i,formId:this.id+"-unit-selects",orgSelectId:this.id+"-org-select",libSelectId:this.id+"-lib-select"})),this.orgSelect=new n({el:this.$(".organizations"),picker:this.picker,appId:this.appId,collection:new r({},{appId:this.appId})}),this.libSelect=new a({el:this.$(".libraries"),picker:this.picker,appId:this.appId,collection:new o({},{appId:this.appId})})},events:{"change select.organizations":"changeOrganization","change select.libraries":"changeLibrary"},changeOrganization:function(e){this.picker.model.set({organizationId:e.target.value}),this.loadLibraries()},changeLibrary:function(e){this.picker.model.set({libraryId:e.target.value})},loadOrgs:function(){var e=new r({},{appId:this.appId});e.fetch({picker:this.picker,success:t.bind(function(e,t,i){this.orgSelect.collection.reset(e.models)},this),error:t.bind(function(e,i,s){this.ajaxError(i,t.bind(function(){this.loadOrgs()},this))},this)})},loadLibraries:function(){var e=this.picker.model.get("organizationId"),i=new o({},{organizationId:e,appId:this.appId});i.fetch({picker:this.picker,cacheKey:e,success:t.bind(function(e,t,i){this.libSelect.collection.reset(e.models)},this),error:t.bind(function(e,i,s){this.ajaxError(i,t.bind(function(){this.loadLibraries()},this))},this)})}})}),function(e){"use strict";"function"==typeof n&&n.amd?n("ev-scroll-loader",["jquery"],e):e("object"==typeof module&&"object"==typeof module.exports?s("jquery"):jQuery)}(function(e){"use strict";var t={onScrolled:function(){}},i={init:function(i){var s=e.extend({},t,i);return this.each(function(){var t=e(this),i=t.wrap('<div class="scrollWrap"/>').closest(".scrollWrap");t.addClass("scroll-content"),i.append('<div class="loader"></div>'),i.css({position:"relative",height:s.height?"number"==typeof s.height?s.height+"px":s.height:"100%","max-height":t[0].scrollHeight+"px","overflow-y":"scroll"}),i.scroll(function(){i.scrollTop()>=i[0].scrollHeight-i.height()-1&&s.onScrolled.call(t)})})},showLoader:function(){var t=e(this).closest(".scrollWrap");return e(".loader",t).show(),this},hideLoader:function(){var t=e(this).closest(".scrollWrap");return e(".loader",t).hide(),this}};e.fn.evScrollLoader=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:i.init.apply(this,arguments)}}),n("text!ev-script/templates/results.html",[],function(){return'<div class="total">\n    <%= sprintf(messages[\'Search returned %1$s results.\'], totalResults) %>\n    <a href="#" class="action-refresh" title="<%= messages[\'Reload\'] %>"><i class="fa fa-fw fa-lg fa-refresh"></i></a>\n</div>\n<div class="results">\n    <table class="content-list"></table>\n</div>\n'}),n("text!ev-script/templates/no-results.html",[],function(){return'<tr class="odd"><td colspan="2"><%= messages[\'No results available.\'] %></td></tr>\n'}),n("ev-script/views/results",["require","jquery","underscore","i18n!ev-script/nls/messages","sprintf","ev-script/views/base","ev-scroll-loader","text!ev-script/templates/results.html","text!ev-script/templates/no-results.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("i18n!ev-script/nls/messages"),n=e("sprintf"),r=e("ev-script/views/base");return e("ev-scroll-loader"),r.extend({resultsTemplate:i.template(e("text!ev-script/templates/results.html")),emptyTemplate:i.template(e("text!ev-script/templates/no-results.html")),initialize:function(e){r.prototype.initialize.call(this,e),i.bindAll(this,"render","loadMore","addHandler","previewItem","setHeight","resizeResults","refreshHandler"),this.picker=e.picker,this.appId=e.appId,this.loadLock=!1},events:{"click .action-preview":"previewItem","click .action-refresh":"refreshHandler"},getItemHtml:function(e,t){return this.resultTemplate?this.resultTemplate({messages:s,sprintf:n.sprintf,item:e,index:t}):void 0},previewItem:function(e){var i=e.currentTarget,s=t(i).attr("rel"),n=this.collection.get(s),r={id:s,content:n.toJSON(),appId:this.appId};new this.previewClass({el:i,model:new this.modelClass(r),appId:this.appId,picker:this.picker});e.stopPropagation(),e.preventDefault()},loadMore:function(){this.collection.hasMore&&!this.loadLock&&(this.loadLock=!0,this.collection.fetch({remove:!1,picker:this.picker,success:i.bind(function(e,t,s){i.size(t.Data)<this.config.pageSize?(e.hasMore=!1,this.$scrollLoader.evScrollLoader("hideLoader")):(e.hasMore=!0,e.pageIndex+=1),this.loadLock=!1},this),error:i.bind(function(e,t,s){this.ajaxError(t,i.bind(function(){this.loadMore()},this)),this.loadLock=!1},this)}))},addHandler:function(e,i,s){var n=t(this.getItemHtml(e,i.indexOf(e)));this.decorate(n),this.$(".content-list").append(n)},decorate:function(e){},render:function(){this.$el.html(this.resultsTemplate({messages:s,sprintf:n.sprintf,totalResults:this.collection.totalResults})),this.$total=this.$(".total"),this.$results=this.$(".results"),this.resizeResults();var e=this.$(".content-list");this.collection.isEmpty()?e.append(this.emptyTemplate({messages:s})):this.collection.each(function(i,s){var n=t(this.getItemHtml(i,s));this.decorate(n),e.append(n)},this);var i=this.config.scrollHeight;this.$scrollLoader=e.evScrollLoader({height:i,onScrolled:this.loadMore}),this.collection.hasMore||this.$scrollLoader.evScrollLoader("hideLoader"),this.collection.off("add",this.addHandler).on("add",this.addHandler)},setHeight:function(e){this.$el.height(e),this.resizeResults()},resizeResults:function(){this.config.fitToParent&&this.$results&&(this.$results.height(this.$el.height()-this.$total.outerHeight(!0)),this.$(".resultItem").each(i.bind(function(e,i){this.decorate(t(i))},this)))},refreshHandler:function(e){}})}),n("ev-script/views/preview",["require","jquery","underscore","ev-script/views/base","ev-script/models/video-settings","jquery-ui"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("ev-script/views/base");e("ev-script/models/video-settings");return e("jquery-ui"),s.extend({initialize:function(e){s.prototype.initialize.call(this,e);var n,r=t('<div class="dialogWrap ev-preview"></div>'),a=new this.embedClass({model:new this.model.constructor(this.model.toJSON()),appId:this.appId}),o=50,l=this.info.useLegacyEmbeds()?140:50,c=Math.min(a.getFrameWidth()+o,t(window).width()-this.config.dialogMargin),u=Math.min(a.getFrameHeight()+l,t(window).height()-this.config.dialogMargin);this.$el.after(r),a.scale(c-o,u-l),n=r.dialog({title:this.getTitle(),modal:!0,width:c,height:u,draggable:!1,resizable:!1,dialogClass:"ev-dialog",create:i.bind(function(e,t){a.render(),r.html(a.$el)},this),close:function(e,t){r.dialog("destroy").remove()}})},getTitle:function(){var e=this.model.get("content")||{Title:this.model.get("id")};return this.unencode(e.Title||e.Name)}})}),n("ev-script/views/embed",["require","underscore","ev-script/views/base"],function(e){"use strict";var t=(e("underscore"),e("ev-script/views/base"));return t.extend({initialize:function(e){t.prototype.initialize.call(this,e)},render:function(){},getFrameWidth:function(){return this.model.get("width")},getFrameHeight:function(){return this.model.get("height")},scale:function(e,t){}})}),n("text!ev-script/templates/video-embed.html",[],function(){return'<iframe src="<%- ensembleUrl %>/app/plugin/embed.aspx?ID=<%- id %>&autoPlay=<%- autoPlay %>&displayTitle=<%- displayTitle %>&displaySharing=<%- displaySharing %>&displayAnnotations=<%- displayAnnotations %>&displayCaptionSearch=<%- displayCaptionSearch %>&displayAttachments=<%- displayAttachments %>&audioPreviewImage=<%- audioPreviewImage %>&displayLinks=<%- displayLinks %>&displayMetaData=<%- displayMetaData %>&displayDateProduced=<%- displayDateProduced %>&displayEmbedCode=<%- displayEmbedCode %>&displayDownloadIcon=<%- displayDownloadIcon %>&hideControls=true&showCaptions=<%- showCaptions %>&width=<%- width %>&height=<%- height %>&isNewPluginEmbed=true"\n        frameborder="0"\n        width="<%- width %>"\n        height="<%- frameHeight %>"\n        allowfullscreen>\n</iframe>\n'}),n("text!ev-script/templates/video-embed-legacy.html",[],function(){return'<iframe src="<%- ensembleUrl %>/app/plugin/embed.aspx?ID=<%- id %>&autoPlay=<%- autoPlay %>&displayTitle=<%- displayTitle %>&hideControls=<%- hideControls %>&showCaptions=<%- showCaptions %>&width=<%- width %>&height=<%- height %>"\n        frameborder="0"\n        style="width: <%- width %>px;height:<%- (parseInt(height, 10) + 56) %>px;"\n        allowfullscreen>\n</iframe>\n'}),n("ev-script/views/video-embed",["require","underscore","ev-script/views/embed","text!ev-script/templates/video-embed.html","text!ev-script/templates/video-embed-legacy.html"],function(e){"use strict";var t=e("underscore"),i=e("ev-script/views/embed");return i.extend({template:t.template(e("text!ev-script/templates/video-embed.html")),legacyTemplate:t.template(e("text!ev-script/templates/video-embed-legacy.html")),initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){var e=this.getMediaWidth(),t=this.getMediaHeight(),i=this.model.get("showtitle"),s="";s=this.info.useLegacyEmbeds()?this.legacyTemplate({ensembleUrl:this.config.ensembleUrl,id:this.model.get("id"),autoPlay:this.model.get("autoplay"),displayTitle:i,hideControls:this.model.get("hidecontrols"),showCaptions:this.model.get("showcaptions"),width:e,height:i?t+25:t}):this.template({ensembleUrl:this.config.ensembleUrl,id:this.model.get("id"),autoPlay:this.model.get("autoplay"),displayTitle:i,displaySharing:this.model.get("socialsharing"),displayAnnotations:this.model.get("annotations"),displayCaptionSearch:this.model.get("captionsearch"),displayAttachments:this.model.get("attachments"),audioPreviewImage:this.model.get("audiopreviewimage"),displayLinks:this.model.get("links"),displayMetaData:this.model.get("metadata"),displayDateProduced:this.model.get("dateproduced"),displayEmbedCode:this.model.get("embedcode"),displayDownloadIcon:this.model.get("download"),showCaptions:this.model.get("showcaptions"),width:e,height:t,frameHeight:this.getFrameHeight()}),this.$el.html(s)},getMediaWidth:function(){return parseInt(this.model.get("width"),10)||640},getMediaHeight:function(){return parseInt(this.model.get("height"),10)||360},getFrameWidth:function(){return this.getMediaWidth()},getFrameHeight:function(){var e=this.getMediaHeight(),t=this.model.get("isaudio"),i=this.model.get("audiopreviewimage");return t?e=this.isMenuVisible()?i?e+40:155:i?e:40:e+=40,e},isMenuVisible:function(){return this.model.get("showtitle")||this.model.get("socialsharing")||this.model.get("annotations")||this.model.get("captionsearch")||this.model.get("attachments")||this.model.get("links")||this.model.get("metadata")||this.model.get("dateproduced")||this.model.get("embedcode")||this.model.get("download")},scale:function(e,t){var i,s=this.getFrameWidth(),n=this.getFrameHeight(),r=this.getMediaWidth(),a=this.getMediaHeight();if(!this.model.get("isaudio"))for(;s>e||n>t;)i=s>e?e/s:t/n,this.model.set("width",Math.floor(r*i)),this.model.set("height",Math.floor(a*i)),s=this.getFrameWidth(),n=this.getFrameHeight(),r=this.getMediaWidth(),a=this.getMediaHeight()}})}),n("ev-script/models/base",["require","jquery","underscore","backbone","ev-script/util/cache","ev-script/collections/base"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("backbone"),n=e("ev-script/util/cache");e("ev-script/collections/base");return s.Model.extend({initialize:function(e,t){this.appId=t.appId,this.config=n.getAppConfig(this.appId)},getCached:function(){},setCached:function(){},fetch:function(e){return e&&e.success&&(e.success=i.wrap(e.success,i.bind(function(e){var t=Array.prototype.slice.call(arguments,1);this.requiresAuth&&!this.auth.isAuthenticated()?this.auth.fetchUser().always(function(){e.apply(this,t)}):e.apply(this,t)},this))),s.Model.prototype.fetch.call(this,e)},sync:function(e,n,r){if(i.defaults(r||(r={}),{xhrFields:{withCredentials:!0}}),"read"===e){var a=this.getCached(r.cacheKey);if(a){var o=t.Deferred();return r.success&&o.done(r.success),o.resolve(a).promise()}return r.success=r.success||function(e,t,i){},r.success=i.wrap(r.success,i.bind(function(e){this.setCached(r.cacheKey,arguments[1]),e.apply(this,Array.prototype.slice.call(arguments,1))},this)),s.Model.prototype.sync.call(this,e,n,r)}return s.Model.prototype.sync.call(this,e,n,r)}})}),n("ev-script/models/video-encoding",["require","backbone","ev-script/models/base","underscore","ev-script/util/cache"],function(e){"use strict";var t=e("backbone"),i=e("ev-script/models/base"),s=e("underscore");e("ev-script/util/cache");return i.extend({idAttribute:"videoID",initialize:function(e,t){i.prototype.initialize.call(this,e,t),this.requiresAuth=!1},getCached:function(e){},setCached:function(e,t){},url:function(){var e=this.config.ensembleUrl+"/app/api/content/show.json/"+this.get("fetchId");return this.config.urlCallback?this.config.urlCallback(e):e},getDims:function(){var e=this.get("dimensions")||"640x360",t=e.split("x"),i=[],s=parseInt(t[0],10)||640,n=parseInt(t[1],10)||360;return this.isAudio()?(i[0]=400,i[1]=26):this.config.defaultVideoWidth?(i[0]=parseInt(this.config.defaultVideoWidth,10)||640,i[1]=Math.ceil(i[0]/(s/n))):(i[0]=s,i[1]=n),i},getRatio:function(){var e=this.getDims();return e[0]/e[1]},
getWidth:function(){return this.getDims()[0]},getHeight:function(){return this.getDims()[1]},isAudio:function(){return/^audio/i.test(this.get("contentType")||"")},parse:function(e){return s.isArray(e.dataSet.encodings)?s.max(e.dataSet.encodings,function(e,t,i){return parseInt(e.bitRate,10)}):e.dataSet.encodings},sync:function(e,i,n){return s.extend(n,{dataFilter:function(e){var t=e.match(/\{[\s\S]*\}/);return t?t[0]:e}}),t.sync.call(this,e,i,n)},updateSettingsModel:function(e){var t={width:this.getWidth(),height:this.getHeight(),isaudio:this.isAudio()};e.set(t)}})}),n("ev-script/views/video-preview",["require","underscore","ev-script/views/preview","ev-script/views/video-embed","ev-script/models/video-encoding"],function(e){"use strict";var t=e("underscore"),i=e("ev-script/views/preview"),s=e("ev-script/views/video-embed"),n=e("ev-script/models/video-encoding");return i.extend({embedClass:s,initialize:function(e){this.appId=e.appId,this.encoding=e.encoding||new n({fetchId:this.model.id},{appId:this.appId}),this.picker=e.picker;var s=t.bind(function(){this.encoding.updateSettingsModel(this.model),this.encoding.updateSettingsModel(this.picker.model),i.prototype.initialize.call(this,e)},this);this.encoding.isNew()?this.encoding.fetch({success:s,picker:this.picker}):s()}})}),function(e){var t=/(\s*\S+|\s)$/;e.truncate=function(t,i){return e("<div></div>").append(t).truncate(i).html()},e.fn.truncate=function(i){e.isNumeric(i)&&(i={length:i});var s=e.extend({},e.truncate.defaults,i);return this.each(function(){var i=e(this);s.noBreaks&&i.find("br").replaceWith(" ");var n=i.text(),r=n.length-s.length;s.stripTags&&i.text(n),s.words&&r>0&&(r=n.length-n.slice(0,s.length).replace(t,"").length-1),0>r||!r&&!s.truncated||e.each(i.contents().get().reverse(),function(t,i){var n=e(i),a=n.text(),o=a.length;return r>=o?(s.truncated=!0,r-=o,void n.remove()):3===i.nodeType?(e(i.splitText(o-r-1)).replaceWith(s.ellipsis),!1):(n.truncate(e.extend(s,{length:o-r})),!1)})})},e.truncate.defaults={stripTags:!1,words:!1,noBreaks:!1,length:1/0,ellipsis:""}}(jQuery),n("jquery-truncate-html",function(){}),n("text!ev-script/templates/video-result.html",[],function(){return'<tr class="<%= (index % 2 ? \'odd\' : \'even\') %> resultItem">\n    <td class="content-actions">\n        <div class="thumbnail-wrap">\n            <img class="thumbnail" src="<%= item.get(\'ThumbnailUrl\').replace(/width=100/i, \'width=200\') %>" alt="<%= sprintf(messages[\'%1$s thumbnail image\'], item.get(\'Title\')) %>"/>\n            <% if (item.get(\'IsCaptioned\')) { %>\n            <i class="ccbadge fa fa-cc fa-lg text-dark5" title="<%= messages[\'CC\'] %>" alt="CC"></i>\n            <% } %>\n        </div>\n        <div class="action-links">\n            <a class="action-add" href="#" title="<%= sprintf(messages[\'Choose %1$s\'], item.get(\'Title\')) %>" rel="<%= item.get(\'ID\') %>"><i class="fa fa-plus-circle fa-lg"></i><span><%= messages[\'Choose\'] %></span></a>\n            <a class="action-preview" href="#" title="<%= sprintf(messages[\'Preview: %1$s\'], item.get(\'Title\')) %>" rel="<%= item.get(\'ID\') %>"><i class="fa fa-play-circle fa-lg"></i><span><%= sprintf(messages[\'Preview: %1$s\'], item.get(\'Title\')) %></span></a>\n        </div>\n    </td>\n    <td class="content-meta">\n        <table class="content-item">\n            <tbody>\n                <tr class="title">\n                    <td colspan="2">\n                        <a class="action-preview" title="<%= sprintf(messages[\'Preview: %1$s\'], item.get(\'Title\')) %>" href="#" rel="<%= item.get(\'ID\') %>"><%= item.get(\'Title\') %></a>\n                    </td>\n                </tr>\n                <tr class="trunc"><td class="label"><%= messages[\'Description\'] %></td><td class="value"><%= item.get(\'Description\') %></td></tr>\n                <tr><td class="label"><%= messages[\'Date Added\'] %></td><td class="value"><%- new Date(item.get(\'AddedOn\')).toLocaleString() %></td></tr>\n                <tr class="trunc"><td class="label"><%= messages[\'Keywords\'] %></td><td class="value"><%= item.get(\'Keywords\') %></td></tr>\n                <tr><td class="label"><%= messages[\'Library\'] %></td><td class="value"><%- item.get(\'LibraryName\') %></td></tr>\n            </tbody>\n        </table>\n    </td>\n</tr>\n'}),n("ev-script/views/video-results",["require","jquery","underscore","i18n!ev-script/nls/messages","ev-script/views/results","ev-script/models/video-settings","ev-script/views/video-preview","jquery-truncate-html","text!ev-script/templates/video-result.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("i18n!ev-script/nls/messages"),n=e("ev-script/views/results"),r=e("ev-script/models/video-settings"),a=e("ev-script/views/video-preview");return e("jquery-truncate-html"),n.extend({modelClass:r,previewClass:a,resultTemplate:i.template(e("text!ev-script/templates/video-result.html")),initialize:function(e){n.prototype.initialize.call(this,e)},decorate:function(e){t(".trunc .value",e).each(function(e){var i,n,r=t(this),a=100,o=r.data("fullText")||r.html(),l=t.truncate(o,{length:a,stripTags:!0,noBreaks:!0});if(r.empty(),t(window).width()<1100&&o.length>a){r.data("fullText",o),i=t("<span>"+o+"</span>"),n=t("<span>"+l+"</span>");var c=t('<a href="#">'+s.Less+"</a>").click(function(e){i.hide(),n.show(),e.preventDefault()}),u=t('<a href="#">'+s.More+"</a>").click(function(e){n.hide(),i.show(),e.preventDefault()});i.hide().append(c),n.append(u),r.append(n).append(i)}else r.append(o)})},refreshHandler:function(e){e.preventDefault(),this.appEvents.trigger("reloadVideos")}})}),n("ev-script/collections/videos",["require","ev-script/collections/base","ev-script/util/cache","underscore"],function(e){"use strict";var t=e("ev-script/collections/base"),i=e("ev-script/util/cache"),s=e("underscore");return t.extend({initialize:function(e,i){t.prototype.initialize.call(this,e,i),this.libraryId=i.libraryId||"",this.filterOn=i.filterOn||"",this.filterValue=i.filterValue||"",this.info.checkVersion(">=4.1.0")?this.sourceUrl="shared"===i.sourceId?"/api/SharedLibrary":"/api/MediaLibrary":this.sourceUrl="shared"===i.sourceId?"/api/SharedContent":"/api/Content",this.pageIndex=1},_cache:function(e,t){var s=null,n=this.auth.getUser(),r=n?i.getUserCache(this.config.ensembleUrl,n.id):null;if(r){var a=r.get("videos");a||r.set("videos",a=new i.Cache),s=a[t?"set":"get"](e,t)}return s},getCached:function(e){return this._cache(e)},setCached:function(e,t){return this._cache(e,t)},clearCache:function(){var e=this.auth.getUser(),t=e?i.getUserCache(this.config.ensembleUrl,e.id):null;t&&t.set("videos",null)},url:function(){var e=this.config.ensembleUrl+this.sourceUrl,t="PageSize="+this.config.pageSize,i="PageIndex="+this.pageIndex,s="FilterOn="+encodeURIComponent(this.filterOn),n="FilterValue="+encodeURIComponent(this.filterValue),r=e+"/"+this.libraryId+"?"+t+"&"+i+"&"+s+"&"+n;return this.config.urlCallback?this.config.urlCallback(r):r},parse:function(e){var t=e.Data;return s.each(t,function(e){e.Description=s.unescape(e.Description),e.Keywords=s.unescape(e.Keywords)}),t}})}),n("ev-script/collections/media-workflows",["require","ev-script/collections/base","ev-script/util/cache"],function(e){"use strict";var t=e("ev-script/collections/base"),i=e("ev-script/util/cache");return t.extend({initialize:function(e,i){t.prototype.initialize.call(this,e,i),this.filterValue=i.libraryId||""},_cache:function(e,t){var s=null,n=this.auth.getUser(),r=n?i.getUserCache(this.config.ensembleUrl,n.id):null;if(r){var a=r.get("workflows");a||r.set("workflows",a=new i.Cache),s=a[t?"set":"get"](e,t)}return s},getCached:function(e){return this._cache(e)},setCached:function(e,t){return this._cache(e,t)},url:function(){var e=this.config.ensembleUrl+"/api/MediaWorkflows",t="PageSize=9999",i="PageIndex=1",s="FilterOn=LibraryId",n="FilterValue="+encodeURIComponent(this.filterValue),r=e+"?"+t+"&"+i+"&"+s+"&"+n;return this.config.urlCallback?this.config.urlCallback(r):r},parse:function(e){return this.settings=e.Settings,e.Data}})}),n("ev-script/views/workflow-select",["require","underscore","i18n!ev-script/nls/messages","ev-script/views/base","text!ev-script/templates/options.html"],function(e){"use strict";var t=e("underscore"),i=e("i18n!ev-script/nls/messages"),s=e("ev-script/views/base");return s.extend({template:t.template(e("text!ev-script/templates/options.html")),initialize:function(e){s.prototype.initialize.call(this,e),t.bindAll(this,"render"),this.$el.html('<option value="-1">'+i["Loading..."]+"</option>"),this.render()},render:function(){var e=this.collection.findWhere({IsDefault:!0})||this.collection.at(0);this.$el.html(this.template({selectedId:e.id,collection:this.collection}))},getSelected:function(){return this.collection.get(this.$("option:selected").val())}})}),n("text!ev-script/templates/upload.html",[],function(){return'<form class="upload-form" method="POST" action="">\n    <select class="form-select" name="MediaWorkflowID"></select>\n    <div class="fieldWrap">\n        <label for="Title"><%= messages[\'Title\'] %> *</label>\n        <input class="form-text" type="text" name="Title" id="Title" />\n    </div>\n    <div class="fieldWrap">\n        <label for="Description"><%= messages[\'Description\'] %></label>\n        <textarea class="form-text" name="Description" id="Description" />\n    </div>\n    <div class="upload"></div>\n</form>\n'}),n("ev-script/views/upload",["require","jquery","underscore","i18n!ev-script/nls/messages","plupload","ev-script/views/base","backbone","ev-script/views/workflow-select","ev-script/models/video-settings","jquery.plupload.queue","text!ev-script/templates/upload.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("i18n!ev-script/nls/messages"),n=e("plupload"),r=e("ev-script/views/base"),a=(e("backbone"),e("ev-script/views/workflow-select"));e("ev-script/models/video-settings");return e("jquery.plupload.queue"),r.extend({template:i.template(e("text!ev-script/templates/upload.html")),events:{"change select":"handleSelect"},initialize:function(e){r.prototype.initialize.call(this,e),i.bindAll(this,"render","decorateUploader","closeDialog","handleSelect"),this.field=e.field,this.$anchor=this.$el,this.setElement(this.template({messages:s})),this.$upload=this.$(".upload"),this.workflows=e.workflows,this.workflowSelect=new a({appId:this.appId,el:this.$("select")[0],collection:this.workflows}),this.render(),this.decorateUploader(),this.appEvents.on("hidePickers",this.closeDialog)},getWidth:function(){return Math.min(600,t(window).width()-this.config.dialogMargin)},getHeight:function(){return Math.min(400,t(window).height()-this.config.dialogMargin)},decorateUploader:function(){var e="",r=this.workflowSelect.getSelected(),a=parseInt(r.get("MaxUploadSize"),10);this.workflows.settings.SupportedVideo&&(e+=this.workflows.settings.SupportedVideo.replace(/\*\./g,"").replace(/;/g,",").replace(/\s/g,"")),this.workflows.settings.SupportedAudio&&(e+=this.workflows.settings.SupportedAudio.replace(/\*\./g,"").replace(/;/g,",").replace(/\s/g,"")),this.$upload.pluploadQueue()&&this.$upload.pluploadQueue().destroy(),this.$upload.pluploadQueue({url:this.workflows.settings.SubmitUrl,runtimes:"html5,html4,flash",max_file_size:a>0?a+"gb":"12gb",max_file_count:1,max_retries:5,chunk_size:"2mb",unique_names:!1,multiple_queues:!1,multi_selection:!1,drag_drop:!0,multipart:!0,flash_swf_url:this.config.pluploadFlashPath,preinit:{Init:i.bind(function(e,i){t(".plupload_container",this.$upload).removeAttr("title"),t(".plupload_add",this.$upload).text(s["Add file"])},this),PostInit:i.bind(function(e,i){t(".plupload_droptext",this.$upload).text(s["Drag file here."])},this),UploadFile:i.bind(function(e,t){e.settings.multipart_params={Title:this.$("#Title").val(),Description:this.$("#Description").val(),MediaWorkflowID:this.$("select").val()}},this)},init:{StateChanged:i.bind(function(e){switch(e.state){case n.STARTED:e.state===n.STARTED&&(0===t(".plupload_cancel",this.$upload).length&&(this.$cancel=t('<a class="plupload_button plupload_cancel" href="#">'+s["Cancel upload"]+"</a>").insertBefore(t(".plupload_filelist_footer .plupload_clearer",this.$upload)).click(i.bind(function(){e.stop(),this.decorateUploader()},this))),this.$cancel&&this.$cancel.show());break;case n.STOPPED:this.$cancel&&this.$cancel.hide()}},this),BeforeUpload:i.bind(function(e,i){var s=this.$("#Title"),n=s.val();n&&""!==n.trim()||(s.focus(),e.stop(),t(".plupload_upload_status",this.$upload).hide(),t(".plupload_buttons",this.$upload).show())},this),FilesAdded:i.bind(function(t,s){var r=e.split(",");i.each(s,function(e){var s=e.name.split("."),a=s[s.length-1];i.contains(r,a.toLowerCase())||(t.removeFile(e),t.trigger("Error",{code:n.FILE_EXTENSION_ERROR,message:n.translate("File extension error."),file:e}))}),t.files.length>1&&t.splice(0,t.files.length-1)},this),UploadComplete:i.bind(function(){this.closeDialog()},this),FileUploaded:i.bind(function(e,t,i){this.appEvents.trigger("fileUploaded")},this)}}),this.$upload.pluploadQueue().bind("refresh",function(){t("div.upload > div.plupload").css({"z-index":"0"}),t(".plupload_button").css({"z-index":"1"})}),this.$upload.pluploadQueue().refresh()},closeDialog:function(){this.$dialog&&this.$dialog.dialog("close")},handleSelect:function(e){this.decorateUploader()},render:function(){var e=t('<div class="dialogWrap"></div>');this.$anchor.after(e),this.$dialog=e.dialog({title:s["Upload Media to Ensemble"],modal:!0,width:this.getWidth(),height:this.getHeight(),draggable:!1,resizable:!1,dialogClass:"ev-dialog",create:i.bind(function(t,i){e.html(this.$el)},this),close:i.bind(function(t,i){this.$upload.pluploadQueue().destroy(),e.dialog("destroy").remove(),this.appEvents.off("hidePickers",this.closeDialog),this.$dialog=null},this)})}})}),function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var s,n,r=String(t),a=0,o=i,l="";r.charAt(0|a)||(o="=",a%1);l+=o.charAt(63&s>>8-a%1*8)){if(n=r.charCodeAt(a+=.75),n>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");s=s<<8|n}return l}),t.atob||(t.atob=function(t){var s=String(t).replace(/=+$/,"");if(s.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,a=0,o=0,l="";r=s.charAt(o++);~r&&(n=a%4?64*n+r:r,a++%4)?l+=String.fromCharCode(255&n>>(-2*a&6)):0)r=i.indexOf(r);return l})}(),n("base64",function(){}),n("text!ev-script/templates/anthem.html",[],function(){return'<iframe src="ensemble://<%= tokenDetailsApiUrl %>" style="display:none;"></iframe>\n'}),n("ev-script/views/video-picker",["require","jquery","underscore","i18n!ev-script/nls/messages","platform","ev-script/views/picker","ev-script/views/search","ev-script/views/library-type-select","ev-script/views/unit-selects","ev-script/views/video-results","ev-script/collections/videos","ev-script/collections/media-workflows","ev-script/views/upload","base64","text!ev-script/templates/anthem.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("i18n!ev-script/nls/messages"),n=e("platform"),r=e("ev-script/views/picker"),a=e("ev-script/views/search"),o=e("ev-script/views/library-type-select"),l=e("ev-script/views/unit-selects"),c=e("ev-script/views/video-results"),u=e("ev-script/collections/videos"),h=e("ev-script/collections/media-workflows"),d=e("ev-script/views/upload");return e("base64"),r.extend({anthemTemplate:i.template(e("text!ev-script/templates/anthem.html")),initialize:function(e){r.prototype.initialize.call(this,e),i.bindAll(this,"loadVideos","loadWorkflows","changeLibrary","handleSubmit","uploadHandler","recordHandler");var n=i.bind(function(){this.loadVideos()},this);this.$filterBlock=this.$("div.ev-filter-block"),this.info.get("ApplicationVersion")&&(this.$actions=t('<div class="ev-actions"></div>'),this.$upload=t('<button type="button" class="action-upload" title="'+s.Upload+'"><i class="fa fa-upload fa-fw"></i><span>'+s.Upload+"<span></button>").css("display","none"),this.$actions.append(this.$upload),this.$record=t('<button type="button" class="action-record" title="'+s.Record+'"><i class="record-inactive fa fa-circle fa-fw"></i><i class="record-active fa fa-refresh fa-spin fa-fw" style="display:none;"></i><span>'+s.Record+"<span></button>").css("display","none"),this.$actions.append(this.$record),this.$filterBlock.prepend(this.$actions)),this.searchView=new a({id:this.id+"-search",tagName:"div",className:"ev-search",picker:this,appId:this.appId,callback:n}),this.$filterBlock.prepend(this.searchView.$el),this.searchView.render(),this.typeSelectView=new o({id:this.id+"-type-select",tagName:"div",className:"ev-type-select",picker:this,appId:this.appId,callback:n}),this.$filterBlock.prepend(this.typeSelectView.$el),this.typeSelectView.render(),this.info.get("ApplicationVersion")&&(this.unitSelects=new l({id:this.id+"-unit-selects",tagName:"div",className:"ev-unit-selects",picker:this,appId:this.appId}),this.$filterBlock.prepend(this.unitSelects.$el)),this.resultsView=new c({el:this.$("div.ev-results"),picker:this,appId:this.appId}),this.$el.append(this.resultsView.$el)},events:{"click .action-add":"chooseItem","click .action-upload":"uploadHandler","click .action-record":"recordHandler","change .unit-selects select.libraries":"changeLibrary","submit .unit-selects":"handleSubmit"},changeLibrary:function(e){this.loadVideos(),this.loadWorkflows()},handleSubmit:function(e){this.loadVideos(),e.preventDefault()},uploadHandler:function(e){new d({appId:this.appId,field:this.field,workflows:this.workflows});e.preventDefault()},recordHandler:function(e){var s,r,a=t(".record-active",this.$record),o=t(".record-inactive",this.$record),l=i.bind(function(){this.anthemLaunching=!0,o.hide(),a.show()},this),c=i.bind(function(){this.anthemLaunching=!1,o.show(),a.hide(),s&&clearInterval(s),r&&clearTimeout(r)},this);return this.anthemLaunching?(e.preventDefault(),!1):(l(),t.ajax({url:this.config.ensembleUrl+"/api/record/token/CreateToken",data:{libraryId:this.model.get("libraryId")},xhrFields:{withCredentials:!0}}).done(i.bind(function(e){e&&"00000000-0000-0000-0000-000000000000"!==e?(this.$("#anthemContainer").html(this.anthemTemplate({tokenDetailsApiUrl:window.btoa(this.config.ensembleUrl+"/api/record/token/GetDetails?token="+e)})),s=setInterval(i.bind(function(){t.ajax({url:this.config.ensembleUrl+"/api/record/token/IsActive",xhrFields:{withCredentials:!0},data:{token:e}}).done(function(e){e||c()}).fail(function(){c()})},this),5e3),r=setTimeout(i.bind(function(){c(),/windows/i.test(n.os.family)?window.location=this.config.ensembleUrl+"/app/unprotected/EnsembleAnthem/EnsembleAnthem.msi":window.location=this.config.ensembleUrl+"/app/unprotected/EnsembleAnthem/EnsembleAnthem.dmg"},this),3e4)):c()},this)).fail(c),void e.preventDefault())},showPicker:function(){r.prototype.showPicker.call(this),this.info.get("ApplicationVersion")?(this.unitSelects.loadOrgs(),this.unitSelects.$("select").filter(":visible").first().focus()):(this.searchView.$('input[type="text"]').focus(),this.loadVideos())},loadVideos:function(){var e=t.trim(this.model.get("search").toLowerCase()),s=this.model.get("sourceId"),n=this.model.get("libraryId"),r=s+n+e,a=new u({},{sourceId:s,libraryId:n,filterOn:"",filterValue:e,appId:this.appId}),o=i.bind(function(){a.clearCache(),this.loadVideos()},this);a.fetch({picker:this,cacheKey:r,success:i.bind(function(e,t,s){var n=e.totalResults=parseInt(t.Pager.TotalRecords,10),r=i.size(t.Data);r===n?e.hasMore=!1:(e.hasMore=!0,e.pageIndex+=1),this.resultsView.collection=e,this.resultsView.render()},this),error:i.bind(function(e,t,s){this.ajaxError(t,i.bind(function(){this.loadVideos()},this))},this)}),this.appEvents.off("fileUploaded").on("fileUploaded",o),this.appEvents.off("reloadVideos").on("reloadVideos",o)},loadWorkflows:function(){this.workflows=new h({},{appId:this.appId}),this.workflows.filterValue=this.model.get("libraryId"),this.workflows.fetch({cacheKey:this.workflows.filterValue,success:i.bind(function(e,t,i){e.isEmpty()?(this.$upload.css("display","none"),this.$record.css("display","none")):(this.$upload.css("display","inline-block"),this.canRecord()&&this.$record.css("display","inline-block")),this.resizeResults()},this),error:i.bind(function(e,t,s){this.ajaxError(t,i.bind(function(){this.loadWorkflows()},this))},this),reset:!0})},resizeResults:function(){this.config.fitToParent&&this.resultsView.setHeight(this.$el.height()-this.hider.$el.outerHeight(!0)-this.$filterBlock.outerHeight(!0))},canRecord:function(){var e=this.auth.getUser();return this.info.anthemEnabled()&&e&&e.get("CanUseAnthem")&&!this.isMobile()&&"Linux"!==n.os.family},isMobile:function(){var e=n.os.family;return"Android"===e||"iOS"===e||"Windows Phone"===e}})}),n("ev-script/views/settings",["require","underscore","ev-script/views/base","jquery-ui"],function(e){"use strict";var t=e("underscore"),i=e("ev-script/views/base");return e("jquery-ui"),i.extend({initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"show","cancelHandler","submitHandler"),this.field=e.field},events:{submit:"submitHandler","click .action-cancel":"cancelHandler"},show:function(){this.render(),this.$el.dialog("open")},cancelHandler:function(e){this.$el.dialog("close"),e.preventDefault()},submitHandler:function(e){this.updateModel(),this.$el.dialog("close"),e.preventDefault()},updateModel:function(){}})}),n("ev-script/util/size",["require","underscore"],function(e){"use strict";var t=e("underscore");return{optionsSixteenByNine:["1280x720","1024x576","848x480","720x405","640x360","610x344","560x315","480x270","400x225","320x180","240x135","160x90"],optionsFourByThree:["1280x960","1024x770","848x636","720x540","640x480","610x460","560x420","480x360","400x300","320x240","240x180","160x120"],ratiosAreRoughlyEqual:function(e,t){return Math.ceil(10*e)/10===Math.ceil(10*t)/10},getAvailableDimensions:function(e){e=e||16/9;var t=this.optionsSixteenByNine;return this.ratiosAreRoughlyEqual(e,4/3)&&(t=this.optionsFourByThree),t},findClosestDimension:function(e,i){var s,n=Number.MAX_VALUE,r=t.isNumber(e)?this.getAvailableDimensions(e):e,a=t.find(r,t.bind(function(e){var t=parseInt(e.split("x")[0],10),r=Math.abs(t-i);return n>r&&(n=r,s=e),0===r},this));return a||s}}}),n("text!ev-script/templates/video-settings.html",[],function(){return'<form>\n    <fieldset>\n        <div class="fieldWrap">\n            <label for="size"><%= messages[\'Size\'] %></label>\n            <select class="form-select size" id="size" name="size">\n                <option value="original"><%= messages[\'Original\'] %></option>\n            </select>\n        </div>\n        <div>\n            <div class="fieldWrap inline-option">\n                <input id="showtitle" class="form-checkbox" <% if (model.get(\'showtitle\')) { print(\'checked="checked"\'); } %> name="showtitle" type="checkbox"/>\n                <label for="showtitle"><%= messages[\'Title\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="socialsharing" class="form-checkbox" <% if (model.get(\'socialsharing\')) { print(\'checked="checked"\'); } %> name="socialsharing" type="checkbox"/>\n                <label for="socialsharing"><%= messages[\'Social Tools\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="annotations" class="form-checkbox" <% if (model.get(\'annotations\')) { print(\'checked="checked"\'); } %> name="annotations" type="checkbox"/>\n                <label for="annotations"><%= messages[\'Annotations\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="captionsearch" class="form-checkbox" <% if (model.get(\'captionsearch\')) { print(\'checked="checked"\'); } %> name="captionsearch" type="checkbox"/>\n                <label for="captionsearch"><%= messages[\'Caption Search\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="autoplay" class="form-checkbox" <% if (model.get(\'autoplay\')) { print(\'checked="checked"\'); } %>  name="autoplay" type="checkbox"/>\n                <label for="autoplay"><%= messages[\'Auto Play (PC Only)\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="attachments" class="form-checkbox" <% if (model.get(\'attachments\')) { print(\'checked="checked"\'); } %> name="attachments" type="checkbox"/>\n                <label for="attachments"><%= messages[\'Attachments\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="links" class="form-checkbox" <% if (model.get(\'links\')) { print(\'checked="checked"\'); } %> name="links" type="checkbox"/>\n                <label for="links"><%= messages[\'Links\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="metadata" class="form-checkbox" <% if (model.get(\'metadata\')) { print(\'checked="checked"\'); } %> name="metadata" type="checkbox"/>\n                <label for="metadata"><%= messages[\'Meta Data\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="dateproduced" class="form-checkbox" <% if (model.get(\'dateproduced\')) { print(\'checked="checked"\'); } %> name="dateproduced" type="checkbox"/>\n                <label for="dateproduced"><%= messages[\'Date Produced\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="embedcode" class="form-checkbox" <% if (model.get(\'embedcode\')) { print(\'checked="checked"\'); } %> name="embedcode" type="checkbox"/>\n                <label for="embedcode"><%= messages[\'Embed Code\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="download" class="form-checkbox" <% if (model.get(\'download\')) { print(\'checked="checked"\'); } %> name="download" type="checkbox"/>\n                <label for="download"><%= messages[\'Download Link\'] %></label>\n            </div>\n            <div class="fieldWrap inline-option">\n                <input id="showcaptions" class="form-checkbox" <% if (model.get(\'showcaptions\')) { print(\'checked="checked"\'); } %>  name="showcaptions" type="checkbox"/>\n                <label for="showcaptions"><%= messages[\'Captions "On" By Default\'] %></label>\n            </div>\n            <% if (isAudio) { %>\n                <div class="fieldWrap inline-option">\n                    <input id="audiopreviewimage" class="form-checkbox" <% if (model.get(\'audiopreviewimage\')) { print(\'checked="checked"\'); } %>  name="audiopreviewimage" type="checkbox"/>\n                    <label for="audiopreviewimage"><%= messages[\'Audio Preview Image\'] %></label>\n                </div>\n            <% } %>\n         </div>\n        <div class="form-actions">\n            <button type="submit" class="form-submit action-submit" value="Submit"><i class="fa fa-save"></i><span><%= messages[\'Save\'] %></span></button>\n            <button type="button" class="form-submit action-cancel" value="Cancel"><i class="fa fa-times"></i><span><%= messages[\'Cancel\'] %></span></button>\n        </div>\n    </fieldset>\n</form>\n'}),n("text!ev-script/templates/video-settings-legacy.html",[],function(){return'<form>\n    <fieldset>\n        <div class="fieldWrap">\n            <label for="size"><%= messages[\'Size\'] %></label>\n            <select class="form-select size" id="size" name="size" <% if (isAudio) { print(\'disabled\'); } %> >\n                <option value="original"><%= messages[\'Original\'] %></option>\n            </select>\n        </div>\n        <div class="fieldWrap">\n            <label for="showtitle"><%= messages[\'Show Title\'] %></label>\n            <input id="showtitle" class="form-checkbox" <% if (model.get(\'showtitle\')) { print(\'checked="checked"\'); } %> name="showtitle" type="checkbox"/>\n        </div>\n        <div class="fieldWrap">\n            <label for="autoplay"><%= messages[\'Auto Play\'] %></label>\n            <input id="autoplay" class="form-checkbox" <% if (model.get(\'autoplay\')) { print(\'checked="checked"\'); } %>  name="autoplay" type="checkbox"/>\n        </div>\n        <div class="fieldWrap">\n            <label for="showcaptions"><%= messages[\'Show Captions\'] %></label>\n            <input id="showcaptions" class="form-checkbox" <% if (model.get(\'showcaptions\')) { print(\'checked="checked"\'); } %>  name="showcaptions" type="checkbox" <% if (isAudio) { print(\'disabled\'); } %> />\n        </div>\n        <div class="fieldWrap">\n            <label for="hidecontrols"><%= messages[\'Hide Controls\'] %></label>\n            <input id="hidecontrols" class="form-checkbox" <% if (model.get(\'hidecontrols\')) { print(\'checked="checked"\'); } %>  name="hidecontrols" type="checkbox" <% if (isAudio) { print(\'disabled\'); } %> />\n        </div>\n        <div class="form-actions">\n            <input type="button" class="form-submit action-cancel" value="<%= messages[\'Cancel\'] %>"/>\n            <input type="submit" class="form-submit action-submit" value="<%= messages[\'Submit\'] %>"/>\n        </div>\n    </fieldset>\n</form>\n'}),n("text!ev-script/templates/sizes.html",[],function(){return'<% _.each(sizes, function(size) { %>\n    <option value="<%= size %>" <% if (size === target) { print(\'selected="selected"\'); } %>><%= size %></option>\n<% }); %>\n'}),n("ev-script/views/video-settings",["require","jquery","underscore","i18n!ev-script/nls/messages","ev-script/views/settings","ev-script/util/size","jquery-ui","text!ev-script/templates/video-settings.html","text!ev-script/templates/video-settings-legacy.html","text!ev-script/templates/sizes.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("i18n!ev-script/nls/messages"),n=e("ev-script/views/settings"),r=e("ev-script/util/size");return e("jquery-ui"),n.extend({template:i.template(e("text!ev-script/templates/video-settings.html")),legacyTemplate:i.template(e("text!ev-script/templates/video-settings-legacy.html")),sizesTemplate:i.template(e("text!ev-script/templates/sizes.html")),initialize:function(e){n.prototype.initialize.call(this,e),this.encoding=e.encoding,this.encoding.on("change:id",i.bind(function(){this.render()},this))},updateModel:function(){var e={showtitle:this.$("#showtitle").is(":checked"),autoplay:this.$("#autoplay").is(":checked"),showcaptions:this.$("#showcaptions").is(":checked"),hidecontrols:this.$("#hidecontrols").is(":checked")};this.info.useLegacyEmbeds()||(e=i.extend(e,{socialsharing:this.$("#socialsharing").is(":checked"),annotations:this.$("#annotations").is(":checked"),captionsearch:this.$("#captionsearch").is(":checked"),attachments:this.$("#attachments").is(":checked"),audiopreviewimage:this.$("#audiopreviewimage").is(":checked"),links:this.$("#links").is(":checked"),metadata:this.$("#metadata").is(":checked"),dateproduced:this.$("#dateproduced").is(":checked"),embedcode:this.$("#embedcode").is(":checked"),download:this.$("#download").is(":checked")}));var t=this.$("#size").val();if(t&&"original"!==t){var s=t.split("x");i.extend(e,{width:parseInt(s[0],10),height:parseInt(s[1],10)})}else this.encoding&&!this.encoding.isNew()&&i.extend(e,{width:this.encoding.getWidth(),height:this.encoding.getHeight()});this.field.model.set(e)},renderSize:function(){var e=this.field.model.get("width"),t=this.field.model.get("height"),i=16/9,s=[];e&&t?i=e/t:this.encoding.id&&(e=this.encoding.getWidth(),t=this.encoding.getHeight(),i=this.encoding.getRatio()),s=r.getAvailableDimensions(i),this.$(".size").append(this.sizesTemplate({
sizes:s,target:r.findClosestDimension(s,this.config.defaultVideoWidth||e)}))},render:function(){var e="";e=this.info.useLegacyEmbeds()?this.legacyTemplate({messages:s,model:this.field.model,isAudio:this.encoding&&this.encoding.isAudio()}):this.template({messages:s,model:this.field.model,isAudio:this.encoding&&this.encoding.isAudio()}),this.$el.html(e),this.encoding&&this.renderSize();var i=this.field.model.get("content");this.$el.dialog({title:this.unencode(i?i.Title:this.field.model.get("id")),modal:!0,autoOpen:!1,draggable:!1,resizable:!1,dialogClass:"ev-dialog",width:Math.min(680,t(window).width()-this.config.dialogMargin),height:Math.min(260,t(window).height()-this.config.dialogMargin)})}})}),n("text!ev-script/templates/playlist-embed.html",[],function(){return'<iframe src="<%- ensembleUrl %>/app/plugin/embed.aspx?DestinationID=<%- modelId %>&playlistEmbed=true&isNewPluginEmbed=true&hideControls=true&displayTitle=true&displayEmbedCode=<%- displayEmbedCode %>&displayStatistics=<%- displayStatistics %>&displayVideoDuration=<%- displayDuration %>&displayAttachments=<%- displayAttachments %>&displayAnnotations=<%- displayAnnotations %>&displayLinks=<%- displayLinks %>&displayCredits=<%- displayCredits %>&displaySharing=<%- displaySharing %>&autoPlay=<%- autoPlay %>&showCaptions=<%- showCaptions %>&displayDateProduced=<%- displayDateProduced %>&audioPreviewImage=<%- audioPreviewImage %>&displayCaptionSearch=<%- displayCaptionSearch %>&<% if (isShowcase) { print(showcaseParams); } else { print(playlistParams); } %>"\n        frameborder="0"\n        style="width:<%- width %>px;height:<%- height %>px;"\n        width="<%- width %>"\n        height="<%- height %>"\n        allowfullscreen>\n</iframe>\n'}),n("text!ev-script/templates/playlist-embed-legacy.html",[],function(){return'<iframe src="<%- ensembleUrl %>/app/plugin/embed.aspx?DestinationID=<%- modelId %>"\n        frameborder="0"\n        style="width:<%- width %>px;height:<%- height %>px;"\n        width="<%- width %>"\n        height="<%- height %>"\n        allowfullscreen>\n</iframe>\n'}),n("text!ev-script/templates/playlist-embed-playlist-params.html",[],function(){return"orderBy=<%- playlistSortBy %>&orderByDirection=<%- playlistSortDirection %><% if (playlistSearchString) { print('&searchString=' + playlistSearchString); } %><% if (playlistCategory) { print('&categoryID=' + playlistCategory); } %><% if (playlistNumberOfResults) { print('&resultsCount=' + playlistNumberOfResults); } %>"}),n("text!ev-script/templates/playlist-embed-showcase-params.html",[],function(){return"displayShowcase=true<% if (categoryList) { %>&displayCategoryList=true&categoryOrientation=<%- categoryOrientation %><% } %>"}),n("ev-script/views/playlist-embed",["require","underscore","ev-script/views/embed","text!ev-script/templates/playlist-embed.html","text!ev-script/templates/playlist-embed-legacy.html","text!ev-script/templates/playlist-embed-playlist-params.html","text!ev-script/templates/playlist-embed-showcase-params.html"],function(e){"use strict";var t=e("underscore"),i=e("ev-script/views/embed");return i.extend({template:t.template(e("text!ev-script/templates/playlist-embed.html")),legacyTemplate:t.template(e("text!ev-script/templates/playlist-embed-legacy.html")),playlistParamsTemplate:t.template(e("text!ev-script/templates/playlist-embed-playlist-params.html")),showcaseParamsTemplate:t.template(e("text!ev-script/templates/playlist-embed-showcase-params.html")),initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){var e="";if(this.info.useLegacyEmbeds())e=this.legacyTemplate({modelId:this.model.get("id"),width:this.getFrameWidth(),height:this.getFrameHeight(),ensembleUrl:this.config.ensembleUrl});else{var i={modelId:this.model.get("id"),width:this.getFrameWidth(),height:this.getFrameHeight(),ensembleUrl:this.config.ensembleUrl,displayEmbedCode:this.model.get("embedcode"),displayStatistics:this.model.get("statistics"),displayDuration:this.model.get("duration"),displayAttachments:this.model.get("attachments"),displayAnnotations:this.model.get("annotations"),displayLinks:this.model.get("links"),displayCredits:this.model.get("credits"),displaySharing:this.model.get("socialsharing"),autoPlay:this.model.get("autoplay"),showCaptions:this.model.get("showcaptions"),displayDateProduced:this.model.get("dateproduced"),audioPreviewImage:this.model.get("audiopreviewimage"),displayCaptionSearch:this.model.get("captionsearch")};if("showcase"===this.model.get("layout")){var s=this.model.get("showcaseLayout");i=t.extend(i,{isShowcase:!0,showcaseParams:this.showcaseParamsTemplate({categoryList:s.categoryList,categoryOrientation:s.categoryOrientation})})}else{var n=this.model.get("playlistLayout");i=t.extend(i,{isShowcase:!1,playlistParams:this.playlistParamsTemplate({playlistSortBy:n.playlistSortBy,playlistSortDirection:n.playlistSortDirection,playlistSearchString:n.playlistSearchString,playlistCategory:n.playlistCategory,playlistNumberOfResults:n.playlistNumberOfResults})})}e=this.template(i)}this.$el.html(e)}})}),n("ev-script/views/playlist-preview",["require","ev-script/views/preview","ev-script/views/playlist-embed"],function(e){"use strict";var t=e("ev-script/views/preview"),i=e("ev-script/views/playlist-embed");return t.extend({initialize:function(e){t.prototype.initialize.call(this,e)},embedClass:i})}),n("text!ev-script/templates/playlist-result.html",[],function(){return'<tr class="<%= (index % 2 ? \'odd\' : \'even\') %>">\n    <td class="content-actions">\n        <div class="action-links">\n            <a class="action-add" href="#" title="<%= sprintf(messages[\'Choose %1$s\'], item.get(\'Name\')) %>" rel="<%= item.get(\'ID\') %>">\n                <i class="fa fa-plus-circle fa-lg"></i><span><%= messages[\'Choose\'] %></span>\n            </a>\n            <a class="action-preview" href="#" title="<%= sprintf(messages[\'Preview: %1$s\'], item.get(\'Name\')) %>" rel="<%= item.get(\'ID\') %>">\n                <i class="fa fa-play-circle fa-lg"></i><span><%= sprintf(messages[\'Preview: %1$s\'], item.get(\'Name\')) %></span>\n            </a>\n        </div>\n    </td>\n    <td class="content-meta">\n        <% if (item.get(\'IsSecure\')) { print(\'<span class="item-security"><i class="fa fa-lock fa-lg"></i></span>\'); } %>\n        <span><%- item.get(\'Name\') %></span>\n    </td>\n</tr>\n'}),n("ev-script/views/playlist-results",["require","underscore","jquery","ev-script/views/results","ev-script/models/playlist-settings","ev-script/views/playlist-preview","text!ev-script/templates/playlist-result.html"],function(e){"use strict";var t=e("underscore"),i=(e("jquery"),e("ev-script/views/results")),s=e("ev-script/models/playlist-settings"),n=e("ev-script/views/playlist-preview");return i.extend({modelClass:s,previewClass:n,resultTemplate:t.template(e("text!ev-script/templates/playlist-result.html")),initialize:function(e){i.prototype.initialize.call(this,e)},refreshHandler:function(e){e.preventDefault(),this.appEvents.trigger("reloadPlaylists")}})}),n("ev-script/collections/playlists",["require","ev-script/collections/base","ev-script/util/cache"],function(e){"use strict";var t=e("ev-script/collections/base"),i=e("ev-script/util/cache");return t.extend({initialize:function(e,i){t.prototype.initialize.call(this,e,i),this.libraryId=i.libraryId||"",this.filterValue=i.filterValue||"",this.pageIndex=1},_cache:function(e,t){var s=null,n=this.auth.getUser(),r=n?i.getUserCache(this.config.ensembleUrl,n.id):null;if(r){var a=r.get("playlists");a||r.set("playlists",a=new i.Cache),s=a[t?"set":"get"](e,t)}return s},getCached:function(e){return this._cache(e)},setCached:function(e,t){return this._cache(e,t)},clearCache:function(){var e=this.auth.getUser(),t=e?i.getUserCache(this.config.ensembleUrl,e.id):null;t&&t.set("playlists",null)},url:function(){var e,t,i,s=this.config.ensembleUrl+"/api/Playlists",n="PageSize="+this.config.pageSize,r="PageIndex="+this.pageIndex;return this.info.get("ApplicationVersion")?(t="FilterOn=Name",i="FilterValue="+encodeURIComponent(this.filterValue),e=s+"/"+encodeURIComponent(this.libraryId)+"?"+n+"&"+r+(this.filterValue?"&"+t+"&"+i:"")):(t="FilterOn=LibraryId",i="FilterValue="+encodeURIComponent(this.libraryId),e=s+"?"+n+"&"+r+"&"+t+"&"+i),this.config.urlCallback?this.config.urlCallback(e):e}})}),n("ev-script/views/playlist-picker",["require","jquery","underscore","ev-script/views/picker","ev-script/views/unit-selects","ev-script/views/search","ev-script/views/playlist-results","ev-script/collections/playlists"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("ev-script/views/picker"),n=e("ev-script/views/unit-selects"),r=e("ev-script/views/search"),a=e("ev-script/views/playlist-results"),o=e("ev-script/collections/playlists");return s.extend({initialize:function(e){s.prototype.initialize.call(this,e),i.bindAll(this,"loadPlaylists","changeLibrary","handleSubmit"),this.$filterBlock=this.$("div.ev-filter-block"),this.info.get("ApplicationVersion")&&(this.searchView=new r({id:this.id+"-search",tagName:"div",className:"ev-search",picker:this,appId:this.appId,callback:i.bind(function(){this.loadPlaylists()},this)}),this.$filterBlock.prepend(this.searchView.$el),this.searchView.render()),this.unitSelects=new n({id:this.id+"-unit-selects",tagName:"div",className:"ev-unit-selects",picker:this,appId:this.appId}),this.$filterBlock.prepend(this.unitSelects.$el),this.resultsView=new a({el:this.$("div.ev-results"),picker:this,appId:this.appId}),this.$el.append(this.resultsView.$el)},events:{"click a.action-add":"chooseItem","change .unit-selects select.libraries":"changeLibrary","submit .unit-selects":"handleSubmit"},changeLibrary:function(e){this.loadPlaylists()},handleSubmit:function(e){this.loadPlaylists(),e.preventDefault()},showPicker:function(){s.prototype.showPicker.call(this),this.unitSelects.loadOrgs(),this.unitSelects.$("select").filter(":visible").first().focus()},loadPlaylists:function(){var e=t.trim(this.model.get("search").toLowerCase()),s=this.model.get("libraryId"),n=new o({},{libraryId:s,filterValue:e,appId:this.appId}),r=i.bind(function(){n.clearCache(),this.loadPlaylists()},this);n.fetch({picker:this,cacheKey:s+e,success:i.bind(function(e,t,s){var n=e.totalResults=parseInt(t.Pager.TotalRecords,10),r=i.size(t.Data);r===n?e.hasMore=!1:(e.hasMore=!0,e.pageIndex+=1),this.resultsView.collection=e,this.resultsView.render(),this.resizeResults()},this),error:i.bind(function(e,t,s){this.ajaxError(t,i.bind(function(){this.loadPlaylists()},this))},this)}),this.appEvents.off("reloadPlaylists").on("reloadPlaylists",r)},resizeResults:function(){this.config.fitToParent&&this.resultsView.setHeight(this.$el.height()-this.hider.$el.outerHeight(!0)-this.$filterBlock.outerHeight(!0))}})}),n("ev-script/collections/categories",["require","backbone","ev-script/collections/base","underscore"],function(e){"use strict";var t=e("backbone"),i=e("ev-script/collections/base"),s=e("underscore");return i.extend({initialize:function(e,t){i.prototype.initialize.call(this,e,t),this.requiresAuth=!1,this.playlistId=t.playlistId||""},url:function(){var e=this.config.ensembleUrl+"/app/api/category/list.json/"+this.playlistId;return this.config.urlCallback?this.config.urlCallback(e):e},parse:function(e){return e.dataSet?e.dataSet.category||[]:[]},sync:function(e,i,n){return s.extend(n,{dataFilter:function(e){var t=e.match(/\{[\s\S]*\}/);return t?t[0]:e}}),t.sync.call(this,e,i,n)}})}),n("text!ev-script/templates/playlist-settings.html",[],function(){return'<form>\n    <fieldset>\n        <div class="accordion">\n            <h4><%= messages[\'Choose Layout\'] %></h4>\n            <div>\n                <div class="fieldWrap inline-option">\n                    <input id="playlist" class="form-radio" <% if (model.get(\'layout\') === \'playlist\') { print(\'checked="checked"\'); } %> name="layout" value="playlist" type="radio"/>\n                    <label for="playlist"><%= messages[\'Playlist\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="showcase" class="form-radio" <% if (model.get(\'layout\') === \'showcase\') { print(\'checked="checked"\'); } %> name="layout" value="showcase" type="radio"/>\n                    <label for="showcase"><%= messages[\'Showcase\'] %></label>\n                </div>\n            </div>\n            <h4><%= messages[\'Layout Options\'] %></h4>\n            <div>\n                <div class="playlistOptions" <% if (model.get(\'layout\') === \'showcase\') { print(\'style="display:none;"\'); } %>>\n                    <div class="fieldWrap">\n                        <label for="playlistSortBy"><%= messages[\'Sort By\'] %></label>\n                        <select id="playlistSortBy" class="form-select">\n                            <option value="videoDate" <% if (model.get(\'playlistLayout\').playlistSortBy === \'videoDate\') { print(\'selected="selected"\'); } %>><%= messages[\'Date Added\'] %></option>\n                            <option value="videoDateProduced" <% if (model.get(\'playlistLayout\').playlistSortBy === \'videoDateProduced\') { print(\'selected="selected"\'); } %>><%= messages[\'Date Produced\'] %></option>\n                            <option value="videoDescription" <% if (model.get(\'playlistLayout\').playlistSortBy === \'videoDescription\') { print(\'selected="selected"\'); } %>><%= messages[\'Description\'] %></option>\n                            <option value="videoTitle" <% if (model.get(\'playlistLayout\').playlistSortBy === \'videoTitle\') { print(\'selected="selected"\'); } %>><%= messages[\'Title\'] %></option>\n                            <option value="videoDuration" <% if (model.get(\'playlistLayout\').playlistSortBy === \'videoDuration\') { print(\'selected="selected"\'); } %>><%= messages[\'Duration\'] %></option>\n                            <option value="videoKeywords" <% if (model.get(\'playlistLayout\').playlistSortBy === \'videoKeywords\') { print(\'selected="selected"\'); } %>><%= messages[\'Keywords\'] %></option>\n                            <!-- <option value="videoCustomPosition">Custom Order</option> -->\n                        </select>\n                    </div>\n                    <div>\n                        <div class="fieldWrap inline-option">\n                            <input id="playlistSortDirectionAsc" class="form-radio" <% if (model.get(\'playlistLayout\').playlistSortDirection === \'asc\') { print(\'checked="checked"\'); } %> name="playlistSortDirection" value="asc" type="radio"/>\n                            <label for="playlist"><%= messages[\'Ascending\'] %></label>\n                        </div>\n                        <div class="fieldWrap inline-option">\n                            <input id="playlistSortDirectionDesc" class="form-radio" <% if (model.get(\'playlistLayout\').playlistSortDirection === \'desc\') { print(\'checked="checked"\'); } %> name="playlistSortDirection" value="desc" type="radio"/>\n                            <label for="playlist"><%= messages[\'Descending\'] %></label>\n                        </div>\n                    </div>\n                    <div>\n                        <div class="fieldWrap">\n                            <label for="playlistSearchString"><%= messages[\'Search String\'] %></label>\n                            <input id="playlistSearchString" class="form-text" name="playlistSearchString" value="<%- model.get(\'playlistLayout\').playlistSearchString %>" type="text"/>\n                        </div>\n                        <div class="fieldWrap">\n                            <label for="playlistCategory"><%= messages[\'Category\'] %></label>\n                            <select id="playlistCategory" class="form-select" name="playlistCategory">\n                                <option value="" <% if (!model.get(\'playlistLayout\').playlistCategory) { print(\'selected="selected"\'); } %>>-- <%= messages[\'None\'] %> --</option>\n                                <% categories.each(function(category) { %>\n                                    <option value="<%= category.id %>" <% if (model.get(\'playlistLayout\').playlistCategory === category.id) { print(\'selected="selected"\'); } %>><%- category.get(\'categoryName\') %></option>\n                                <% }); %>\n                            </select>\n                        </div>\n                        <div class="fieldWrap">\n                            <label for="playlistNumberOfResults"><%= messages[\'Number of Results\'] %></label>\n                            <input id="playlistNumberOfResults" class="form-text" name="playlistNumberOfResults" value="<%- model.get(\'playlistLayout\').playlistNumberOfResults %>" type="text"/>\n                        </div>\n                    </div>\n                </div>\n                <div class="showcaseOptions" <% if (model.get(\'layout\') === \'playlist\') { print(\'style="display:none;"\'); } %>>\n<!--\n                    <div class="fieldWrap">\n                        <input id="featuredContent" class="form-checkbox" type="checkbox" name="featuredContent" <% if (model.get(\'showcaseLayout\').featuredContent) { print(\'checked="checked"\'); } %>/>\n                        <label for="featuredContent">Featured Content</label>\n                    </div>\n -->\n                    <div class="fieldWrap">\n                        <input id="categoryList" class="form-checkbox" type="checkbox" name="categoryList" <% if (model.get(\'showcaseLayout\').categoryList) { print(\'checked="checked"\'); } %>/>\n                        <label for="categoryList"><%= messages[\'Category List\'] %></label>\n                    </div>\n                    <div>\n                        <div class="fieldWrap">\n                            <input id="categoryOrientationHorizontal" class="form-radio" <% if (model.get(\'showcaseLayout\').categoryOrientation === \'horizontal\') { print(\'checked="checked"\'); } %> <% if (!model.get(\'showcaseLayout\').categoryList) { print(\'disabled\'); } %> name="categoryOrientation" value="horizontal" type="radio"/>\n                            <label for="playlist"><%= messages[\'Horizontal\'] %></label>\n                        </div>\n                        <div class="fieldWrap">\n                            <input id="categoryOrientationVertical" class="form-radio" <% if (model.get(\'showcaseLayout\').categoryOrientation === \'vertical\') { print(\'checked="checked"\'); } %> <% if (!model.get(\'showcaseLayout\').categoryList) { print(\'disabled\'); } %> name="categoryOrientation" value="vertical" type="radio"/>\n                            <label for="playlist"><%= messages[\'Vertical\'] %></label>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4><%= messages[\'Content Details\'] %></h4>\n            <div>\n                <div class="fieldWrap inline-option">\n                    <input id="embedcode" class="form-checkbox" <% if (!isSecure && model.get(\'embedcode\')) { print(\'checked="checked"\'); } %> name="embedcode" type="checkbox" <% if (isSecure) { print(\'disabled\') } %> />\n                    <label for="embedcode"><%= messages[\'Embed Code\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="statistics" class="form-checkbox" <% if (model.get(\'statistics\')) { print(\'checked="checked"\'); } %> name="statistics" type="checkbox"/>\n                    <label for="statistics"><%= messages[\'Statistics\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="duration" class="form-checkbox" <% if (model.get(\'duration\')) { print(\'checked="checked"\'); } %> name="duration" type="checkbox"/>\n                    <label for="duration"><%= messages[\'Duration\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="attachments" class="form-checkbox" <% if (model.get(\'attachments\')) { print(\'checked="checked"\'); } %> name="attachments" type="checkbox"/>\n                    <label for="attachments"><%= messages[\'Attachments\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="annotations" class="form-checkbox" <% if (model.get(\'annotations\')) { print(\'checked="checked"\'); } %> name="annotations" type="checkbox"/>\n                    <label for="annotations"><%= messages[\'Annotations\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="links" class="form-checkbox" <% if (model.get(\'links\')) { print(\'checked="checked"\'); } %> name="links" type="checkbox"/>\n                    <label for="links"><%= messages[\'Links\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="credits" class="form-checkbox" <% if (model.get(\'credits\')) { print(\'checked="checked"\'); } %> name="credits" type="checkbox"/>\n                    <label for="credits"><%= messages[\'Credits\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="socialsharing" class="form-checkbox" <% if (!isSecure && model.get(\'socialsharing\')) { print(\'checked="checked"\'); } %> name="socialsharing" type="checkbox" <% if (isSecure) { print(\'disabled\') } %> />\n                    <label for="socialsharing"><%= messages[\'Social Tools\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="autoplay" class="form-checkbox" <% if (model.get(\'autoplay\')) { print(\'checked="checked"\'); } %>  name="autoplay" type="checkbox"/>\n                    <label for="autoplay"><%= messages[\'Auto Play (PC Only)\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="showcaptions" class="form-checkbox" <% if (model.get(\'showcaptions\')) { print(\'checked="checked"\'); } %>  name="showcaptions" type="checkbox"/>\n                    <label for="showcaptions"><%= messages[\'Captions "On" By Default\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="dateproduced" class="form-checkbox" <% if (model.get(\'dateproduced\')) { print(\'checked="checked"\'); } %> name="dateproduced" type="checkbox"/>\n                    <label for="dateproduced"><%= messages[\'Date Produced\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="audiopreviewimage" class="form-checkbox" <% if (model.get(\'audiopreviewimage\')) { print(\'checked="checked"\'); } %> name="audiopreviewimage" type="checkbox"/>\n                    <label for="audiopreviewimage"><%= messages[\'Audio Preview Image\'] %></label>\n                </div>\n                <div class="fieldWrap inline-option">\n                    <input id="captionsearch" class="form-checkbox" <% if (model.get(\'captionsearch\')) { print(\'checked="checked"\'); } %> name="captionsearch" type="checkbox"/>\n                    <label for="captionsearch"><%= messages[\'Caption Search\'] %></label>\n                </div>\n            </div>\n        </div>\n        <div class="form-actions">\n            <button type="submit" class="form-submit action-submit" value="Submit"><i class="fa fa-save"></i><span><%= messages[\'Save\'] %></span></button>\n            <button type="button" class="form-submit action-cancel" value="Cancel"><i class="fa fa-times"></i><span><%= messages[\'Cancel\'] %></span></button>\n        </div>\n    </fieldset>\n</form>\n'}),n("ev-script/views/playlist-settings",["require","jquery","underscore","i18n!ev-script/nls/messages","ev-script/views/settings","ev-script/collections/categories","jquery-ui","text!ev-script/templates/playlist-settings.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("i18n!ev-script/nls/messages"),n=e("ev-script/views/settings"),r=e("ev-script/collections/categories");return e("jquery-ui"),n.extend({template:i.template(e("text!ev-script/templates/playlist-settings.html")),initialize:function(e){n.prototype.initialize.call(this,e),i.bindAll(this,"changeLayout","changeCategoryList"),this.categories=e.categories,this.categories.on("reset",i.bind(function(){this.render()},this))},events:{submit:"submitHandler","click .action-cancel":"cancelHandler",'change input[name="layout"]':"changeLayout",'change input[name="categoryList"]':"changeCategoryList"},updateModel:function(){var e=this.field.model.get("content"),t={layout:this.$('input[name="layout"]:checked').val(),embedcode:e&&e.IsSecure?!1:this.$("#embedcode").is(":checked"),statistics:this.$("#statistics").is(":checked"),duration:this.$("#duration").is(":checked"),attachments:this.$("#attachments").is(":checked"),annotations:this.$("#annotations").is(":checked"),links:this.$("#links").is(":checked"),credits:this.$("#credits").is(":checked"),socialsharing:e&&e.IsSecure?!1:this.$("#socialsharing").is(":checked"),autoplay:this.$("#autoplay").is(":checked"),showcaptions:this.$("#showcaptions").is(":checked"),dateproduced:this.$("#dateproduced").is(":checked"),audiopreviewimage:this.$("#audiopreviewimage").is(":checked"),captionsearch:this.$("#captionsearch").is(":checked")};"playlist"===t.layout?t.playlistLayout={playlistSortBy:this.$("#playlistSortBy option:selected").val(),playlistSortDirection:this.$('input[name="playlistSortDirection"]:checked').val(),playlistSearchString:this.$("#playlistSearchString").val(),playlistCategory:this.$("#playlistCategory option:selected").val(),playlistNumberOfResults:this.$("#playlistNumberOfResults").val()}:t.showcaseLayout={categoryList:this.$("#categoryList").is(":checked"),categoryOrientation:this.$('input[name="categoryOrientation"]:checked').val()},this.field.model.set(t)},render:function(){var e=this.field.model.get("content"),i=this.template({messages:s,model:this.field.model,isAudio:this.encoding&&this.encoding.isAudio(),isSecure:e&&e.IsSecure,categories:this.categories||new r([],{})});this.$el.html(i),this.$(".accordion").accordion({active:2,heightStyle:"content",collapsible:!0}),this.$el.dialog({title:this.unencode(e?e.Name:this.field.model.get("id")),modal:!0,autoOpen:!1,draggable:!1,resizable:!1,dialogClass:"ev-dialog",width:Math.min(680,t(window).width()-this.config.dialogMargin),height:Math.min(420,t(window).height()-this.config.dialogMargin)})},changeLayout:function(e){"playlist"===e.currentTarget.value?(this.$(".playlistOptions").show(),this.$(".showcaseOptions").hide()):(this.$(".playlistOptions").hide(),this.$(".showcaseOptions").show())},changeCategoryList:function(e){t(e.currentTarget).is(":checked")?(this.$("#categoryOrientationHorizontal").attr("disabled",!1),this.$("#categoryOrientationVertical").attr("disabled",!1)):(this.$("#categoryOrientationHorizontal").attr("disabled",!0),this.$("#categoryOrientationVertical").attr("disabled",!0))}})}),n("text!ev-script/templates/field.html",[],function(){return'<div class="logo">\n    <a target="_blank" href="<%= ensembleUrl %>"><span><%= messages[\'Ensemble Logo\'] %></span></a>\n</div>\n<% if (modelId) { %>\n    <% if (thumbnailUrl) { %>\n        <div class="thumbnail">\n            <img alt="<%= messages[\'Media thumbnail\'] %>" src="<%= thumbnailUrl %>"/>\n        </div>\n    <% } %>\n    <div class="title"><%= name %></div>\n    <div class="ev-actions">\n        <a href="#" class="action-choose" title="<%= sprintf(messages[\'Change %1$s\'], label) %>"><i class="fa fa-folder-open fa-lg"></i><span><%= sprintf(messages[\'Change %1$s\'], label) %><span></a>\n        <a href="#" class="action-preview" title="<%= messages[\'Preview:\'] %> <%= name %>"><i class="fa fa-play-circle fa-lg"></i><span><%= messages[\'Preview:\'] %> <%= name %><span></a>\n        <% if (type === \'video\' || showPlaylistOptions) { %>\n            <a href="#" class="action-options" title="<%= sprintf(messages[\'%1$s Embed Options\'], label) %>"><i class="fa fa-cog fa-lg"></i><span><%= sprintf(messages[\'%1$s Embed Options\'], label) %><span></a>\n        <% } %>\n        <a href="#" class="action-remove" title="<%= sprintf(messages[\'Remove %1$s\'], label) %>"><i class="fa fa-minus-circle fa-lg"></i><span><%= sprintf(messages[\'Remove %1$s\'], label) %><span></a>\n    </div>\n<% } else { %>\n    <div class="title"><em><%= sprintf(messages[\'Add %1$s\'], label) %></em></div>\n    <div class="ev-actions">\n        <a href="#" class="action-choose" title="<%= sprintf(messages[\'Choose %1$s\'], label) %>"><i class="fa fa-folder-open fa-lg"></i><span><%= sprintf(messages[\'Choose %1$s\'], label) %><span></a>\n    </div>\n<% } %>\n'}),n("ev-script/views/field",["require","jquery","underscore","i18n!ev-script/nls/messages","sprintf","ev-script/views/base","ev-script/models/video-settings","ev-script/models/playlist-settings","ev-script/views/video-picker","ev-script/views/video-settings","ev-script/views/video-preview","ev-script/models/video-encoding","ev-script/views/playlist-picker","ev-script/views/playlist-settings","ev-script/views/playlist-preview","ev-script/collections/categories","text!ev-script/templates/field.html"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("i18n!ev-script/nls/messages"),n=e("sprintf"),r=e("ev-script/views/base"),a=e("ev-script/models/video-settings"),o=e("ev-script/models/playlist-settings"),l=e("ev-script/views/video-picker"),c=e("ev-script/views/video-settings"),u=e("ev-script/views/video-preview"),h=e("ev-script/models/video-encoding"),d=e("ev-script/views/playlist-picker"),p=e("ev-script/views/playlist-settings"),f=e("ev-script/views/playlist-preview"),m=e("ev-script/collections/categories");return r.extend({template:i.template(e("text!ev-script/templates/field.html")),initialize:function(e){r.prototype.initialize.call(this,e),i.bindAll(this,"chooseHandler","optionsHandler","removeHandler","previewHandler","resizePicker"),this.$field=e.$field,this.showChoose=!0;var t={id:this.id+"-picker",tagName:"div",className:"ev-"+this.model.get("type")+"-picker",field:this,appId:this.appId},s={id:this.id+"-settings",tagName:"div",className:"ev-settings",field:this,appId:this.appId};this.model instanceof a?(this.modelClass=a,this.pickerClass=l,this.settingsClass=c,this.previewClass=u,this.encoding=new h({},{appId:this.appId}),this.model.isNew()||(this.encoding.set({fetchId:this.model.id}),this.encoding.fetch()),this.model.on("change:id",i.bind(function(){this.model.id?(this.encoding.set({fetchId:this.model.id}),this.encoding.fetch({success:i.bind(function(e){this.encoding.updateSettingsModel(this.model),this.encoding.updateSettingsModel(this.picker.model)},this)})):this.encoding.clear()},this)),i.extend(s,{encoding:this.encoding})):this.model instanceof o&&(this.modelClass=o,this.pickerClass=d,this.settingsClass=p,this.previewClass=f,this.categories=new m([],{appId:this.appId}),this.model.isNew()||(this.categories.playlistId=this.model.id,this.categories.fetch({reset:!0})),this.model.on("change:id",i.bind(function(){this.model.id?(this.categories.playlistId=this.model.id,this.categories.fetch({reset:!0})):(this.categories.reset([],{silent:!0}),this.categories.playlistId="")},this)),i.extend(s,{categories:this.categories})),this.picker=new this.pickerClass(i.extend({},t,{model:new this.modelClass(this.model.toJSON())})),this.settings=new this.settingsClass(s),this.$field.after(this.picker.$el),this.renderActions(),this.model.on("change",i.bind(function(){if(!this.model.isNew()){var e=this.model.toJSON();this.$field.val(JSON.stringify(e)),this.appEvents.trigger("fieldUpdated",this.$field,e),this.renderActions()}},this)),this.appEvents.on("showPicker",function(e){
this.id===e&&(this.$(".action-choose").hide(),this.showChoose=!1,this.config.hidePickers&&this.appEvents.trigger("hidePickers",this.id),this.resizePicker())},this),this.appEvents.on("hidePicker",function(e){this.id===e&&(this.$(".action-choose").show(),this.showChoose=!0)},this),this.appEvents.on("hidePickers",function(e){e&&this.id===e||(this.$(".action-choose").show(),this.showChoose=!0)},this),this.appEvents.on("resize",i.bind(function(){this.resizePicker()},this))},events:{"click .action-choose":"chooseHandler","click .action-preview":"previewHandler","click .action-options":"optionsHandler","click .action-remove":"removeHandler"},chooseHandler:function(e){this.appEvents.trigger("showPicker",this.id),e.preventDefault()},optionsHandler:function(e){this.settings.show(),e.preventDefault()},removeHandler:function(e){this.model.clear(),this.$field.val(""),this.model.set(this.model.defaults,{silent:!0}),this.appEvents.trigger("fieldUpdated",this.$field),this.renderActions(),e.preventDefault()},previewHandler:function(e){var t=e.currentTarget;new this.previewClass({el:t,encoding:this.encoding,model:this.model,picker:this.picker,appId:this.appId});e.preventDefault()},renderActions:function(){var e,i,r,o,l=this.config.ensembleUrl;if(this.model instanceof a?(i=s.Media,r="video"):(i=s.Playlist,r="playlist"),this.model.id){e=this.model.id;var c=this.model.get("content");if(c){e=c.Name||c.Title;var u=this.info.checkVersion(">=4.5.0")?"/api/data/image/":"/app/assets/",h=new RegExp("^"+l.toLocaleLowerCase()+u);c.ThumbnailUrl&&h.test(c.ThumbnailUrl.toLocaleLowerCase())&&(o=c.ThumbnailUrl)}}this.$actions||(this.$actions=t('<div class="ev-field"/>'),this.$field.after(this.$actions)),this.$actions.html(this.template({messages:s,sprintf:n.sprintf,ensembleUrl:l,modelId:this.model.id,label:i,type:r,name:e,thumbnailUrl:o,showPlaylistOptions:!this.info.useLegacyEmbeds()})),this.showChoose||this.$(".action-choose").hide()},resizePicker:function(){this.config.fitToParent&&this.picker.setHeight(this.$el.height()-this.$actions.outerHeight(!0))}})}),function(e){function t(e,t){if(e instanceof r)return e;if("string"!=typeof e)return null;if(e.length>F)return null;var i=t?X[ue]:X[oe];if(!i.test(e))return null;try{return new r(e,t)}catch(s){return null}}function i(e,i){var s=t(e,i);return s?s.version:null}function s(e,i){var s=t(e.trim().replace(/^[=v]+/,""),i);return s?s.version:null}function r(e,t){if(e instanceof r){if(e.loose===t)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>F)throw new TypeError("version is longer than "+F+" characters");if(!(this instanceof r))return new r(e,t);this.loose=t;var i=e.trim().match(t?X[ue]:X[oe]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>B||this.major<0)throw new TypeError("Invalid major version");if(this.minor>B||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>B||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&B>t)return t}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}function a(e,t,i,s){"string"==typeof i&&(s=i,i=void 0);try{return new r(e,i).inc(t,s).version}catch(n){return null}}function o(e,i){if(w(e,i))return null;var s=t(e),n=t(i);if(s.prerelease.length||n.prerelease.length){for(var r in s)if(("major"===r||"minor"===r||"patch"===r)&&s[r]!==n[r])return"pre"+r;return"prerelease"}for(var r in s)if(("major"===r||"minor"===r||"patch"===r)&&s[r]!==n[r])return r}function l(e,t){var i=Le.test(e),s=Le.test(t);return i&&s&&(e=+e,t=+t),i&&!s?-1:s&&!i?1:t>e?-1:e>t?1:0}function c(e,t){return l(t,e)}function u(e,t){return new r(e,t).major}function h(e,t){return new r(e,t).minor}function d(e,t){return new r(e,t).patch}function p(e,t,i){return new r(e,i).compare(t)}function f(e,t){return p(e,t,!0)}function m(e,t,i){return p(t,e,i)}function g(t,i){return t.sort(function(t,s){return e.compare(t,s,i)})}function v(t,i){return t.sort(function(t,s){return e.rcompare(t,s,i)})}function b(e,t,i){return p(e,t,i)>0}function y(e,t,i){return p(e,t,i)<0}function w(e,t,i){return 0===p(e,t,i)}function x(e,t,i){return 0!==p(e,t,i)}function k(e,t,i){return p(e,t,i)>=0}function S(e,t,i){return p(e,t,i)<=0}function C(e,t,i,s){var n;switch(t){case"===":"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),n=e===i;break;case"!==":"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),n=e!==i;break;case"":case"=":case"==":n=w(e,i,s);break;case"!=":n=x(e,i,s);break;case">":n=b(e,i,s);break;case">=":n=k(e,i,s);break;case"<":n=y(e,i,s);break;case"<=":n=S(e,i,s);break;default:throw new TypeError("Invalid operator: "+t)}return n}function I(e,t){if(e instanceof I){if(e.loose===t)return e;e=e.value}return this instanceof I?(this.loose=t,this.parse(e),void(this.semver===De?this.value="":this.value=this.operator+this.semver.version)):new I(e,t)}function $(e,t){if(e instanceof $&&e.loose===t)return e;if(!(this instanceof $))return new $(e,t);if(this.loose=t,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function E(e,t){return new $(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})}function A(e,t){return e=j(e,t),e=M(e,t),e=T(e,t),e=L(e,t)}function P(e){return!e||"x"===e.toLowerCase()||"*"===e}function M(e,t){return e.trim().split(/\s+/).map(function(e){return O(e,t)}).join(" ")}function O(e,t){var i=t?X[ke]:X[xe];return e.replace(i,function(e,t,i,s,n){var r;return P(t)?r="":P(i)?r=">="+t+".0.0 <"+(+t+1)+".0.0":P(s)?r=">="+t+"."+i+".0 <"+t+"."+(+i+1)+".0":n?("-"!==n.charAt(0)&&(n="-"+n),r=">="+t+"."+i+"."+s+n+" <"+t+"."+(+i+1)+".0"):r=">="+t+"."+i+"."+s+" <"+t+"."+(+i+1)+".0",r})}function j(e,t){return e.trim().split(/\s+/).map(function(e){return _(e,t)}).join(" ")}function _(e,t){var i=t?X[Ee]:X[$e];return e.replace(i,function(e,t,i,s,n){var r;return P(t)?r="":P(i)?r=">="+t+".0.0 <"+(+t+1)+".0.0":P(s)?r="0"===t?">="+t+"."+i+".0 <"+t+"."+(+i+1)+".0":">="+t+"."+i+".0 <"+(+t+1)+".0.0":n?("-"!==n.charAt(0)&&(n="-"+n),r="0"===t?"0"===i?">="+t+"."+i+"."+s+n+" <"+t+"."+i+"."+(+s+1):">="+t+"."+i+"."+s+n+" <"+t+"."+(+i+1)+".0":">="+t+"."+i+"."+s+n+" <"+(+t+1)+".0.0"):r="0"===t?"0"===i?">="+t+"."+i+"."+s+" <"+t+"."+i+"."+(+s+1):">="+t+"."+i+"."+s+" <"+t+"."+(+i+1)+".0":">="+t+"."+i+"."+s+" <"+(+t+1)+".0.0",r})}function T(e,t){return e.split(/\s+/).map(function(e){return z(e,t)}).join(" ")}function z(e,t){e=e.trim();var i=t?X[ve]:X[ge];return e.replace(i,function(e,t,i,s,n,r){var a=P(i),o=a||P(s),l=o||P(n),c=l;return"="===t&&c&&(t=""),a?e=">"===t||"<"===t?"<0.0.0":"*":t&&c?(o&&(s=0),l&&(n=0),">"===t?(t=">=",o?(i=+i+1,s=0,n=0):l&&(s=+s+1,n=0)):"<="===t&&(t="<",o?i=+i+1:s=+s+1),e=t+i+"."+s+"."+n):o?e=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(e=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0"),e})}function L(e,t){return e.trim().replace(X[Te],"")}function D(e,t,i,s,n,r,a,o,l,c,u,h,d){return t=P(i)?"":P(s)?">="+i+".0.0":P(n)?">="+i+"."+s+".0":">="+t,o=P(l)?"":P(c)?"<"+(+l+1)+".0.0":P(u)?"<"+l+"."+(+c+1)+".0":h?"<="+l+"."+c+"."+u+"-"+h:"<="+o,(t+" "+o).trim()}function q(e,t){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length){for(var i=0;i<e.length;i++){if(e[i].semver===De)return!0;if(e[i].semver.prerelease.length>0){var s=e[i].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}}return!1}return!0}function U(e,t,i){try{t=new $(t,i)}catch(s){return!1}return t.test(e)}function R(e,t,i){return e.filter(function(e){return U(e,t,i)}).sort(function(e,t){return m(e,t,i)})[0]||null}function H(e,t){try{return new $(e,t).range||"*"}catch(i){return null}}function N(e,t,i){return V(e,t,"<",i)}function W(e,t,i){return V(e,t,">",i)}function V(e,t,i,s){e=new r(e,s),t=new $(t,s);var n,a,o,l,c;switch(i){case">":n=b,a=S,o=y,l=">",c=">=";break;case"<":n=y,a=k,o=b,l="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(U(e,t,s))return!1;for(var u=0;u<t.set.length;++u){var h=t.set[u],d=null,p=null;if(h.forEach(function(e){d=d||e,p=p||e,n(e.semver,d.semver,s)?d=e:o(e.semver,p.semver,s)&&(p=e)}),d.operator===l||d.operator===c)return!1;if((!p.operator||p.operator===l)&&a(e,p.semver))return!1;if(p.operator===c&&o(e,p.semver))return!1}return!0}"object"==typeof module&&module.exports===e&&(e=module.exports=r),e.SEMVER_SPEC_VERSION="2.0.0";var F=256,B=Number.MAX_SAFE_INTEGER||9007199254740991,X=e.re=[],G=e.src=[],K=0,J=K++;G[J]="0|[1-9]\\d*";var Q=K++;G[Q]="[0-9]+";var Z=K++;G[Z]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var Y=K++;G[Y]="("+G[J]+")\\.("+G[J]+")\\.("+G[J]+")";var ee=K++;G[ee]="("+G[Q]+")\\.("+G[Q]+")\\.("+G[Q]+")";var te=K++;G[te]="(?:"+G[J]+"|"+G[Z]+")";var ie=K++;G[ie]="(?:"+G[Q]+"|"+G[Z]+")";var se=K++;G[se]="(?:-("+G[te]+"(?:\\."+G[te]+")*))";var ne=K++;G[ne]="(?:-?("+G[ie]+"(?:\\."+G[ie]+")*))";var re=K++;G[re]="[0-9A-Za-z-]+";var ae=K++;G[ae]="(?:\\+("+G[re]+"(?:\\."+G[re]+")*))";var oe=K++,le="v?"+G[Y]+G[se]+"?"+G[ae]+"?";G[oe]="^"+le+"$";var ce="[v=\\s]*"+G[ee]+G[ne]+"?"+G[ae]+"?",ue=K++;G[ue]="^"+ce+"$";var he=K++;G[he]="((?:<|>)?=?)";var de=K++;G[de]=G[Q]+"|x|X|\\*";var pe=K++;G[pe]=G[J]+"|x|X|\\*";var fe=K++;G[fe]="[v=\\s]*("+G[pe]+")(?:\\.("+G[pe]+")(?:\\.("+G[pe]+")(?:"+G[se]+")?"+G[ae]+"?)?)?";var me=K++;G[me]="[v=\\s]*("+G[de]+")(?:\\.("+G[de]+")(?:\\.("+G[de]+")(?:"+G[ne]+")?"+G[ae]+"?)?)?";var ge=K++;G[ge]="^"+G[he]+"\\s*"+G[fe]+"$";var ve=K++;G[ve]="^"+G[he]+"\\s*"+G[me]+"$";var be=K++;G[be]="(?:~>?)";var ye=K++;G[ye]="(\\s*)"+G[be]+"\\s+",X[ye]=new RegExp(G[ye],"g");var we="$1~",xe=K++;G[xe]="^"+G[be]+G[fe]+"$";var ke=K++;G[ke]="^"+G[be]+G[me]+"$";var Se=K++;G[Se]="(?:\\^)";var Ce=K++;G[Ce]="(\\s*)"+G[Se]+"\\s+",X[Ce]=new RegExp(G[Ce],"g");var Ie="$1^",$e=K++;G[$e]="^"+G[Se]+G[fe]+"$";var Ee=K++;G[Ee]="^"+G[Se]+G[me]+"$";var Ae=K++;G[Ae]="^"+G[he]+"\\s*("+ce+")$|^$";var Pe=K++;G[Pe]="^"+G[he]+"\\s*("+le+")$|^$";var Me=K++;G[Me]="(\\s*)"+G[he]+"\\s*("+ce+"|"+G[fe]+")",X[Me]=new RegExp(G[Me],"g");var Oe="$1$2$3",je=K++;G[je]="^\\s*("+G[fe]+")\\s+-\\s+("+G[fe]+")\\s*$";var _e=K++;G[_e]="^\\s*("+G[me]+")\\s+-\\s+("+G[me]+")\\s*$";var Te=K++;G[Te]="(<|>)?=?\\s*\\*";for(var ze=0;K>ze;ze++)X[ze]||(X[ze]=new RegExp(G[ze]));e.parse=t,e.valid=i,e.clean=s,e.SemVer=r,r.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},r.prototype.inspect=function(){return'<SemVer "'+this+'">'},r.prototype.toString=function(){return this.version},r.prototype.compare=function(e){return e instanceof r||(e=new r(e,this.loose)),this.compareMain(e)||this.comparePre(e)},r.prototype.compareMain=function(e){return e instanceof r||(e=new r(e,this.loose)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)},r.prototype.comparePre=function(e){if(e instanceof r||(e=new r(e,this.loose)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var i=this.prerelease[t],s=e.prerelease[t];if(void 0===i&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===i)return-1;if(i!==s)return l(i,s)}while(++t)},r.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);-1===i&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this},e.inc=a,e.diff=o,e.compareIdentifiers=l;var Le=/^[0-9]+$/;e.rcompareIdentifiers=c,e.major=u,e.minor=h,e.patch=d,e.compare=p,e.compareLoose=f,e.rcompare=m,e.sort=g,e.rsort=v,e.gt=b,e.lt=y,e.eq=w,e.neq=x,e.gte=k,e.lte=S,e.cmp=C,e.Comparator=I;var De={};I.prototype.parse=function(e){var t=this.loose?X[Ae]:X[Pe],i=e.match(t);if(!i)throw new TypeError("Invalid comparator: "+e);this.operator=i[1],"="===this.operator&&(this.operator=""),i[2]?this.semver=new r(i[2],this.loose):this.semver=De},I.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'},I.prototype.toString=function(){return this.value},I.prototype.test=function(e){return this.semver===De?!0:("string"==typeof e&&(e=new r(e,this.loose)),C(e,this.operator,this.semver,this.loose))},e.Range=$,$.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'},$.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},$.prototype.toString=function(){return this.range},$.prototype.parseRange=function(e){var t=this.loose;e=e.trim();var i=t?X[_e]:X[je];e=e.replace(i,D),e=e.replace(X[Me],Oe),e=e.replace(X[ye],we),e=e.replace(X[Ce],Ie),e=e.split(/\s+/).join(" ");var s=t?X[Ae]:X[Pe],n=e.split(" ").map(function(e){return A(e,t)}).join(" ").split(/\s+/);return this.loose&&(n=n.filter(function(e){return!!e.match(s)})),n=n.map(function(e){return new I(e,t)})},e.toComparators=E,$.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new r(e,this.loose));for(var t=0;t<this.set.length;t++)if(q(this.set[t],e))return!0;return!1},e.satisfies=U,e.maxSatisfying=R,e.validRange=H,e.ltr=N,e.gtr=W,e.outside=V,"function"==typeof n&&n.amd&&n("semver",e)}("object"==typeof exports?exports:"function"==typeof n&&n.amd?{}:semver={}),n("ev-script/models/app-info",["require","underscore","semver","ev-script/models/base"],function(e){"use strict";var t=(e("underscore"),e("semver")),i=e("ev-script/models/base");return i.extend({initialize:function(e,t){i.prototype.initialize.call(this,e,t),this.requiresAuth=!1},url:function(){var e=this.config.ensembleUrl+"/api/Info";return this.config.urlCallback?this.config.urlCallback(e):e},parse:function(e){return e},checkVersion:function(e){var i=this.get("ApplicationVersion");return i&&t.satisfies(i,e)},useLegacyEmbeds:function(){return this.checkVersion("<3.12.0")},anthemEnabled:function(){return this.checkVersion(">=4.2.0")}})}),n("ev-script/models/current-user",["require","underscore","ev-script/models/base"],function(e){"use strict";var t=(e("underscore"),e("ev-script/models/base"));return t.extend({idAttribute:"ID",initialize:function(e,i){t.prototype.initialize.call(this,e,i),this.requiresAuth=!1},url:function(){var e=this.config.ensembleUrl+"/api/CurrentUser";return this.config.urlCallback?this.config.urlCallback(e):e},parse:function(e){return e.Data[0]}})}),n("ev-script/auth/base/auth",["require","jquery","underscore","backbone","ev-script/util/events","ev-script/util/cache","ev-script/models/current-user"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("backbone"),n=e("ev-script/util/events"),r=e("ev-script/util/cache"),a=e("ev-script/models/current-user"),o=function(e){i.bindAll(this,"getUser","login","logout","isAuthenticated","handleUnauthorized"),this.appId=e,this.config=r.getAppConfig(e),this.info=r.getAppInfo(e),this.globalEvents=n.getEvents("global"),this.appEvents=n.getEvents(e),this.user=null,this.appEvents.on("appLoaded",function(){this.fetchUser()},this)};return o.extend=s.Model.extend,i.extend(o.prototype,{fetchUser:function(){var e=new a({},{appId:this.appId});return e.fetch({success:i.bind(function(e,t,i){this.user=e,this.globalEvents.trigger("loggedIn",this.config.ensembleUrl)},this),error:i.bind(function(e,t,i){this.user=null,this.globalEvents.trigger("loggedOut",this.config.ensembleUrl)},this)}).promise()},getUser:function(){return this.user},login:function(e){return t.Deferred().reject().promise()},logout:function(){return t.Deferred().reject().promise()},isAuthenticated:function(){return null!=this.user},handleUnauthorized:function(e,t){}}),o}),function(e){"function"==typeof n&&n.amd?n("jquery.cookie",["jquery"],e):e("object"==typeof exports?s("jquery"):jQuery)}(function(e){function t(e){return o.raw?e:encodeURIComponent(e)}function i(e){return o.raw?e:decodeURIComponent(e)}function s(e){return t(o.json?JSON.stringify(e):String(e))}function n(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(a," ")),o.json?JSON.parse(e):e}catch(t){}}function r(t,i){var s=o.raw?t:n(t);return e.isFunction(i)?i(s):s}var a=/\+/g,o=e.cookie=function(n,a,l){if(void 0!==a&&!e.isFunction(a)){if(l=e.extend({},o.defaults,l),"number"==typeof l.expires){var c=l.expires,u=l.expires=new Date;u.setTime(+u+864e5*c)}return document.cookie=[t(n),"=",s(a),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var h=n?void 0:{},d=document.cookie?document.cookie.split("; "):[],p=0,f=d.length;f>p;p++){var m=d[p].split("="),g=i(m.shift()),v=m.join("=");if(n&&n===g){h=r(v,a);break}n||void 0===(v=r(v))||(h[g]=v)}return h};o.defaults={},e.removeCookie=function(t,i){return void 0===e.cookie(t)?!1:(e.cookie(t,"",e.extend({},i,{expires:-1})),!e.cookie(t))}}),n("text!ev-script/auth/basic/template.html",[],function(){return'<div class="logo"></div>\n<form>\n    <fieldset>\n        <div class="fieldWrap">\n            <label for="username"><%= messages[\'Username\'] %></label>\n            <input id="username" name="username" class="form-text" type="text"/>\n        </div>\n        <div class="fieldWrap">\n            <label for="password"><%= messages[\'Password\'] %></label>\n            <input id="password" name="password" class="form-text" type="password"/>\n        </div>\n        <div class="form-actions">\n            <label></label>\n            <input type="submit" class="form-submit action-submit" value="<%= messages[\'Submit\'] %>"/>\n        </div>\n    </fieldset>\n</form>\n'}),n("ev-script/auth/basic/view",["require","exports","module","jquery","underscore","backbone","ev-script/util/cache","ev-script/util/events","i18n!ev-script/nls/messages","jquery.cookie","jquery-ui","text!ev-script/auth/basic/template.html"],function(e,t){"use strict";var i=e("jquery"),s=e("underscore"),n=e("backbone"),r=e("ev-script/util/cache"),a=e("ev-script/util/events"),o=e("i18n!ev-script/nls/messages");return e("jquery.cookie"),e("jquery-ui"),n.View.extend({template:s.template(e("text!ev-script/auth/basic/template.html")),initialize:function(e){this.appId=e.appId,this.config=r.getAppConfig(this.appId),this.appEvents=a.getEvents(this.appId),this.submitCallback=e.submitCallback||function(){},this.auth=e.auth},render:function(){var e=this.template({messages:o});this.$dialog=i('<div class="ev-auth"></div>'),this.$el.after(this.$dialog),this.$dialog.dialog({title:o["Ensemble Video Login"]+" - "+this.config.ensembleUrl,modal:!0,draggable:!1,resizable:!1,width:Math.min(540,i(window).width()-this.config.dialogMargin),height:Math.min(250,i(window).height()-this.config.dialogMargin),dialogClass:"ev-dialog",create:s.bind(function(t,i){this.$dialog.html(e)},this),close:s.bind(function(e,t){this.$dialog.dialog("destroy").remove(),this.appEvents.trigger("hidePickers")},this)}),i("form",this.$dialog).submit(s.bind(function(e){var t=i(e.target),s=i("#username",t).val(),n=i("#password",t).val();s&&n&&(this.auth.login({username:s,password:n}).always(this.submitCallback),this.$dialog.dialog("destroy").remove()),e.preventDefault()},this))}})}),n("ev-script/auth/basic/auth",["require","jquery","underscore","backbone","ev-script/auth/base/auth","ev-script/auth/basic/view","ev-script/collections/organizations"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("backbone"),n=e("ev-script/auth/base/auth"),r=e("ev-script/auth/basic/view"),a=e("ev-script/collections/organizations"),o=n.extend({constructor:function(e){o.__super__.constructor.call(this,e)},fetchUser:function(){if(this.info.get("ApplicationVersion"))return o.__super__.fetchUser.call(this);var e=new a({},{appId:this.appId});return e.requiresAuth=!1,e.fetch({success:i.bind(function(e,t,i){this.user=new s.Model({id:Math.floor(1e16*Math.random()).toString(16)}),this.globalEvents.trigger("loggedIn",this.config.ensembleUrl)},this),error:i.bind(function(e,t,i){this.user=null,this.globalEvents.trigger("loggedOut",this.config.ensembleUrl)},this)}).promise()},login:function(e){var s={path:this.config.authPath};return t.cookie(this.config.ensembleUrl+"-user",e.username,i.extend({},s)),t.cookie(this.config.ensembleUrl+"-pass",e.password,i.extend({},s)),this.fetchUser()},logout:function(){var e=t.Deferred(),s={path:this.config.authPath};return t.removeCookie(this.config.ensembleUrl+"-user",i.extend({},s)),t.removeCookie(this.config.ensembleUrl+"-pass",i.extend({},s)),this.user=null,this.globalEvents.trigger("loggedOut",this.config.ensembleUrl),e.resolve(),e.promise()},handleUnauthorized:function(e,t){this.logout();var i=new r({el:e,submitCallback:t,appId:this.appId,auth:this});i.render()}});return o}),n("text!ev-script/auth/forms/template.html",[],function(){return'<div class="logo"></div>\n<form>\n    <fieldset>\n        <div class="fieldWrap">\n            <label for="username"><%= messages[\'Username\'] %></label>\n            <input id="username" name="username" class="form-text" type="text"/>\n        </div>\n        <div class="fieldWrap">\n            <label for="password"><%= messages[\'Password\'] %></label>\n            <input id="password" name="password" class="form-text" type="password"/>\n        </div>\n        <div class="fieldWrap">\n            <label for="provider"><%= messages[\'Identity Provider\'] %></label>\n            <select id="provider" name="provider" class="form-select"></select>\n        </div>\n        <div class="fieldWrap">\n            <label for="remember"><%= messages[\'Remember Me\'] %></label>\n            <input id="remember" name="remember" type="checkbox"></input>\n        </div>\n        <div class="form-actions">\n            <label></label>\n            <input type="submit" class="form-submit action-submit" value="<%= messages[\'Submit\'] %>"/>\n            <div class="loader"></div>\n        </div>\n    </fieldset>\n</form>\n'}),n("ev-script/auth/forms/view",["require","exports","module","jquery","underscore","backbone","ev-script/util/cache","ev-script/util/events","i18n!ev-script/nls/messages","jquery.cookie","jquery-ui","text!ev-script/auth/forms/template.html","text!ev-script/templates/options.html"],function(e,t){"use strict";var i=e("jquery"),s=e("underscore"),n=e("backbone"),r=e("ev-script/util/cache"),a=e("ev-script/util/events"),o=e("i18n!ev-script/nls/messages");return e("jquery.cookie"),e("jquery-ui"),n.View.extend({template:s.template(e("text!ev-script/auth/forms/template.html")),optionsTemplate:s.template(e("text!ev-script/templates/options.html")),initialize:function(e){this.appId=e.appId,this.config=r.getAppConfig(this.appId),this.appEvents=a.getEvents(this.appId),this.submitCallback=e.submitCallback||function(){},this.auth=e.auth},render:function(){var e=i(this.template({messages:o}));i("#provider",e).append(this.optionsTemplate({collection:this.collection,selectedId:this.config.defaultProvider}));this.$dialog=i('<div class="ev-auth"></div>'),this.$el.after(this.$dialog);var t=i("div.loader",e),n=s.bind(function(e,i,s){t.addClass("loading")},this),r=s.bind(function(e,i,s){t.removeClass("loading")},this);i(window.document).on("ajaxSend",n).on("ajaxComplete",r),this.$dialog.dialog({title:o["Ensemble Video Login"]+" - "+this.config.ensembleUrl,modal:!0,draggable:!1,resizable:!1,width:Math.min(540,i(window).width()-this.config.dialogMargin),height:Math.min(250,i(window).height()-this.config.dialogMargin),dialogClass:"ev-dialog",create:s.bind(function(t,i){this.$dialog.html(e)},this),close:s.bind(function(e,t){i(window.document).off("ajaxSend",n).off("ajaxComplete",r),this.$dialog.dialog("destroy").remove(),this.appEvents.trigger("hidePickers")},this)}),i("form",this.$dialog).submit(s.bind(function(e){var t=i(e.target),n=i("#username",t).val(),r=i("#password",t).val();n&&r&&this.auth.login({username:n,password:r,authSourceId:i("#provider :selected",t).val(),persist:i("#remember",t).is(":checked")}).then(s.bind(function(){this.$dialog.dialog("destroy").remove(),this.submitCallback()},this)),e.preventDefault()},this))}})}),n("ev-script/collections/identity-providers",["require","ev-script/collections/base","ev-script/util/cache"],function(e){"use strict";var t=e("ev-script/collections/base"),i=e("ev-script/util/cache"),s=new i.Cache;return t.extend({initialize:function(e,i){t.prototype.initialize.call(this,e,i),this.requiresAuth=!1},getCached:function(e){return s.get(this.config.ensembleUrl)},setCached:function(e,t){return s.set(this.config.ensembleUrl,t)},url:function(){var e=this.config.ensembleUrl+"/api/IdentityProviders";return this.config.urlCallback?this.config.urlCallback(e):e}})}),n("ev-script/auth/forms/auth",["require","jquery","underscore","ev-script/auth/base/auth","ev-script/models/current-user","ev-script/auth/forms/view","ev-script/collections/identity-providers"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),s=e("ev-script/auth/base/auth"),n=e("ev-script/models/current-user"),r=e("ev-script/auth/forms/view"),a=e("ev-script/collections/identity-providers"),o=s.extend({constructor:function(e){s.prototype.constructor.call(this,e),this.identityProviders=new a({},{appId:e}),this.asPromise=this.identityProviders.fetch()},login:function(e){var s=this.config.ensembleUrl+"/api/Login";return t.ajax({url:this.config.urlCallback?this.config.urlCallback(s):s,type:"POST",dataType:"json",data:{user:e.username,password:e.password,identityProviderId:e.authSourceId,persist:e.persist},xhrFields:{withCredentials:!0},success:i.bind(function(e,t,i){this.user=new n(e.Data[0],{appId:this.appId}),this.globalEvents.trigger("loggedIn",this.config.ensembleUrl)},this)}).promise()},logout:function(){var e=this.config.ensembleUrl+"/api/Logout";return t.ajax({url:this.config.urlCallback?this.config.urlCallback(e):e,type:"POST",xhrFields:{withCredentials:!0},success:i.bind(function(e,t,i){this.user=null,this.globalEvents.trigger("loggedOut",this.config.ensembleUrl)},this)}).promise()},handleUnauthorized:function(e,t){this.user=null,this.globalEvents.trigger("loggedOut",this.config.ensembleUrl),this.asPromise.done(i.bind(function(){var i=new r({el:e,submitCallback:t,appId:this.appId,auth:this,collection:this.identityProviders});i.render()},this))}});return o}),n("text!ev-script/auth/none/template.html",[],function(){return"<div class=\"logo\"></div>\n<form>\n    <h3><%= messages['You are unauthorized to access this content.'] %></h3>\n</form>\n"}),n("ev-script/auth/none/view",["require","exports","module","jquery","underscore","backbone","ev-script/util/cache","ev-script/util/events","i18n!ev-script/nls/messages","jquery-ui","text!ev-script/auth/none/template.html"],function(e,t){"use strict";var i=e("jquery"),s=e("underscore"),n=e("backbone"),r=e("ev-script/util/cache"),a=e("ev-script/util/events"),o=e("i18n!ev-script/nls/messages");return e("jquery-ui"),n.View.extend({template:s.template(e("text!ev-script/auth/none/template.html")),initialize:function(e){this.appId=e.appId,this.config=r.getAppConfig(this.appId),this.appEvents=a.getEvents(this.appId)},render:function(){var e=i(this.template({messages:o}));this.$dialog=i('<div class="ev-auth"></div>'),this.$el.after(this.$dialog),this.$dialog.dialog({title:o["Ensemble Video Login"]+" - "+this.config.ensembleUrl,modal:!0,draggable:!1,resizable:!1,width:Math.min(540,i(window).width()-this.config.dialogMargin),height:Math.min(250,i(window).height()-this.config.dialogMargin),dialogClass:"ev-dialog",create:s.bind(function(t,i){this.$dialog.html(e)},this),close:s.bind(function(e,t){this.$dialog.dialog("destroy").remove(),this.appEvents.trigger("hidePickers")},this)})}})}),n("ev-script/auth/none/auth",["require","jquery","underscore","ev-script/auth/base/auth","ev-script/auth/none/view"],function(e){"use strict";var t=(e("jquery"),e("underscore"),e("ev-script/auth/base/auth")),i=e("ev-script/auth/none/view"),s=t.extend({constructor:function(e){t.prototype.constructor.call(this,e)},handleUnauthorized:function(e,t){this.user=null,this.globalEvents.trigger("loggedOut",this.config.ensembleUrl);var s=new i({el:e,submitCallback:t,appId:this.appId,auth:this,collection:this.identityProviders});s.render()}});return s}),n("ev-script/nls/es-mx/messages",{"%1$s Embed Options":"MX-%1$s Embed Options","%1$s thumbnail image":"MX-%1$s thumbnail image","Add %1$s":"Aadir %1$s","Add file":"Aadir archivo",Annotations:"Anotaciones","An unexpected error occurred.  Check the server log for more details.":"MX-An unexpected error occurred.  Check the server log for more details.",Ascending:"Ascendiendo",Attachments:"Adjuntos","Audio Preview Image":"Prevista del Audio","Auto Play":"Auto Play","Auto Play (PC Only)":"Auto Play (Solo PC)",Cancel:"Cancelar","Cancel upload":"Cancelar cargado","Caption Search":"Bsqueda de Subtitulos",'Captions "On" By Default':'Subtitulos "Encendido" por Defecto',"Category List":"Lista de Categora",Category:"Categora",CC:"CC","Change %1$s":"Cambiar %1$s","Choose %1$s":"Seleccione %1$s","Choose Layout":"Seleccione Diseo",Choose:"Seleccione","Content Details":"Detalles del Contenido","Could not find requested resource.  This is likely a problem with the configured Ensemble Video base url.":"MX-Could not find requested resource.  This is likely a problem with the configured Ensemble Video base url.",Credits:"Crditos","Date Added":"Fecha Aadida","Date Produced":"Fecha de Produccin",Descending:"Descendiente",Description:"Descripcin","Download Link":"Enlace de descarga","Drag file here.":"Arrastre aqu el archivo.",Duration:"Duracin","Embed Code":"Incrustar Cdigo","Ensemble Logo":"MX-Ensemble Logo","Ensemble Video Login":"MX-Ensemble Video Login",Go:"MX-Go","Hide Controls":"Ocultar Controles",Hide:"Ocultar","Hide Picker":"Ocultar Picker",Horizontal:"Horizontal","Identity Provider":"Proveedor de Identidad","It appears there is an issue with the Ensemble Video installation.":"MX-It appears there is an issue with the Ensemble Video installation.",Keywords:"Palabras Clave","Layout Options":"MX-Layout Options",Less:"MX-Less","Library:":"Biblioteca:",Library:"Biblioteca",Links:"Enlaces","Loading...":"Cargando...","Logout %1$s":"Cerrar sesin %1$s",Logout:"Cerrar sesin","Media Library":"Biblioteca de Medios",Media:"Medios","Media thumbnail":"MX-Media thumbnail","Meta Data":"Meta Datos",More:"Ms",None:"Ninguno","No results available.":"MX-No results available.","Number of Results":"Nmero de Resultados","Organization:":"Organizacin:",Original:"Original",Password:"Contrasea",Playlist:"Playlist","Preview: %1$s":"Prevista: %1$s","Preview:":"Prevista:",Reload:"MX-Reload","Remember Me":"Recuerdame","Remove %1$s":"Eliminar %1$s",Save:"Guardar","Search Media":"Buscar Medios","Search:":"Buscar:","Search returned %1$s results.":"MX-Search returned %1$s results.","Search String":"Buscar Cadena de Texto","Select Library":"Seleccionar Biblioteca","Select Library Type":"Seleccionar Tipo de Biblioteca",
"Select Organization":"Seleccionar Organizacin","Shared Library":"Biblioteca Compartida","Show Captions":"MX-Show Captions",Showcase:"Escaparate","Show Title":"Mostrar Ttulo",Size:"Tamao","Social Tools":"Herramientas Sociales","Sort By":"Ordenar Por",Statistics:"Estadsticas",Submit:"Enviar",Title:"Ttulo","Type:":"Tipo:","Upload Media to Ensemble":"MX-Upload Media to Ensemble",Upload:"Cargar",Username:"Nombre de Usuario",Vertical:"Vertical","You are unauthorized to access this content.":"MX-You are unauthorized to access this content."}),n("ev-script",["require","backbone","underscore","jquery","ev-script/models/video-settings","ev-script/models/playlist-settings","ev-script/views/field","ev-script/views/video-embed","ev-script/views/playlist-embed","ev-script/models/app-info","ev-script/auth/basic/auth","ev-script/auth/forms/auth","ev-script/auth/none/auth","ev-script/util/events","ev-script/util/cache","i18n!ev-script/nls/es-mx/messages"],function(e){"use strict";var t=(e("backbone"),e("underscore")),i=e("jquery"),s=e("ev-script/models/video-settings"),n=e("ev-script/models/playlist-settings"),r=e("ev-script/views/field"),a=e("ev-script/views/video-embed"),o=e("ev-script/views/playlist-embed"),l=e("ev-script/models/app-info"),c=e("ev-script/auth/basic/auth"),u=e("ev-script/auth/forms/auth"),h=e("ev-script/auth/none/auth"),d=e("ev-script/util/events"),p=e("ev-script/util/cache");e("i18n!ev-script/nls/es-mx/messages");var f=function(e){var f=Math.floor(1e16*Math.random()).toString(16),m=p.caches.get(e.ensembleUrl);m||(m=p.caches.set(e.ensembleUrl,new p.Cache));var g={ensembleUrl:"",authPath:"",urlCallback:function(e){return e},pageSize:100,scrollHeight:null,fitToParent:!1,hidePickers:!0,dialogMargin:40,authType:"basic",defaultProvider:"",defaultVideoWidth:"",pluploadFlashPath:""},v=p.setAppConfig(f,t.extend({},g,e));d.initEvents(f),this.appEvents=d.getEvents(f),this.globalEvents=d.getEvents();var b=i.Deferred();t.extend(this,b.promise());var y=new l({},{appId:f});p.setAppInfo(f,y),y.fetch({}).always(t.bind(function(){if(y.get("ApplicationVersion")||"forms"!==v.authType){var e;switch(v.authType){case"forms":e=new u(f);break;case"none":e=new h(f);break;default:e=new c(f)}p.setAppAuth(f,e),this.handleField=function(e,t,s){var n=i(s,e);new r({id:e.id||f,el:e,model:t,$field:n,appId:f})},this.handleEmbed=function(e,t){if(t instanceof s){var i=new a({el:e,model:t,appId:f});i.render()}else{var n=new o({el:e,model:t,appId:f});n.render()}},this.getEmbedCode=function(e){var t=i("<div/>");return"video"===e.type?this.handleEmbed(t[0],new s(e)):this.handleEmbed(t[0],new n(e)),t.html()},this.appEvents.trigger("appLoaded"),b.resolve()}else b.reject("Configured to use forms authentication against a pre-3.6 API.")},this))};return{VideoSettings:s,PlaylistSettings:n,EnsembleApp:f}}),n("jquery",function(){return e||jQuery}),n("jquery-ui",["jquery"],function(){}),n("plupload",function(){return t}),n("jquery.plupload.queue",["jquery","plupload"],function(){}),s("jquery.cookie"),s.config({config:{i18n:{locale:(e.cookie("i18n.langtag")||"en-us").toLowerCase()}}}),s("ev-script")});
//# sourceMappingURL=ev-script.min.js.map